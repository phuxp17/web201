<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√°m Ph√° Thi·∫øt K·∫ø CSDL eCommerce (DBML & SQL C·∫≠p Nh·∫≠t)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Visualization & Content Choices:
        - Report Info: SQL Constraints (PK, FK, NOT NULL, UNIQUE, CHECK, DEFAULT) -> Goal: Inform, Understand Rules -> Presentation: Textual descriptions, bulleted examples per constraint. -> Interaction: Static display within tab. -> Justification: Clear explanation of fundamental DB rules. Method: HTML/CSS.
        - Report Info: Product Expiration & Repurposing (revised) -> Goal: Problem/Solution Analysis, Understand Advanced Modeling -> Presentation: Problem statement, updated table structures (Products with 'ImportDate', 'ExpirationDate', ProductTransformations linking directly to Products) with attributes listed in HTML tables, and textual explanations for their necessity. -> Interaction: Static display. -> Justification: Adheres to user's new DBML, clarifies direct product-to-product transformation. Method: HTML/CSS tables for schema.
        - Report Info: Product Reviews -> Goal: Inform, Understand Business Logic -> Presentation: Entity Product_Reviews with attributes and explanation of purchase-based review logic. -> Interaction: Static display. -> Justification: Addresses user request. Method: HTML/CSS table.
        - Report Info: Sales & Coupons -> Goal: Inform, Understand Business Logic -> Presentation: Entities Sales and Coupons with detailed attributes and their specific functionalities. -> Interaction: Static display. -> Justification: Addresses user request. Method: HTML/CSS tables.
        - Report Info: Full SQL Schema -> Goal: Provide executable SQL -> Presentation: Pre-formatted SQL CREATE TABLE statements in a code block. -> Interaction: Copyable text. -> Justification: Direct user request for SQL. Method: HTML pre/code.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .tab-button.active {
            border-bottom-width: 2px;
            border-color: #0284c7; /* sky-600 */
            color: #0284c7; /* sky-600 */
            font-weight: 600;
        }
        .accordion-content {
            display: none;
            transition: max-height 0.3s ease-out;
            overflow: hidden;
        }
        .accordion-button.active .accordion-icon {
            transform: rotate(180deg);
        }
        .entity-list-item.active {
            background-color: #d1fae5; /* emerald-100 */
            color: #059669; /* emerald-600 */
            font-weight: 500;
        }
        .relationship-list-item.active {
            background-color: #e0f2fe; /* sky-100 */
            color: #0284c7; /* sky-600 */
            font-weight: 500;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9; /* stone-100 */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #94a3b8; /* stone-400 */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* stone-500 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .tab-inner-content {
            padding: 1.5rem; /* p-6 */
        }
        table th, table td {
            padding: 0.75rem; /* p-3 */
            vertical-align: top;
        }
        pre {
            background-color: #1a202c; /* gray-900 */
            color: #e2e8f0; /* gray-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800">
    <header class="bg-sky-700 text-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <h1 class="text-xl sm:text-2xl font-semibold">üìä Thi·∫øt K·∫ø CSDL S√†n Th∆∞∆°ng M·∫°i ƒêi·ªán T·ª≠</h1>
                <button id="mobileMenuButton" class="md:hidden p-2 rounded-md text-stone-200 hover:text-white hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
                    <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
            </div>
            <nav id="mainNav" class="md:flex md:space-x-2 border-t border-sky-600 md:border-none hidden md:block">
                <button class="tab-button active text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="entities">üß© C√°c Th·ª±c Th·ªÉ</button>
                <button class="tab-button text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="relationships">üîó M·ªëi Quan H·ªá</button>
                <button class="tab-button text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="constraints">üîí R√†ng Bu·ªôc</button>
                <button class="tab-button text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="expiration-repurpose">‚ôªÔ∏è HSD & T√°i Ch·∫ø</button>
                <button class="tab-button text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="product-reviews">‚≠ê ƒê√°nh Gi√° SP</button>
                <button class="tab-button text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="promotions-coupons">üéÅ Khuy·∫øn M√£i & Coupon</button>
                <button class="tab-button text-sm font-medium py-3 px-2 xl:px-3 text-stone-100 hover:text-white hover:bg-sky-600 rounded-t-md" data-tab="sql-schema">üìÑ L∆∞·ª£c ƒê·ªì SQL</button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        <div id="entities" class="tab-content active bg-white shadow-lg rounded-lg">
            <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">I. X√°c ƒê·ªãnh C√°c Th·ª±c Th·ªÉ Ch√≠nh v√† Thu·ªôc T√≠nh</h2>
                <p class="mb-6 text-stone-700 leading-relaxed">Thi·∫øt k·∫ø c∆° s·ªü d·ªØ li·ªáu cho s√†n th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ ƒëa b√™n ƒë√≤i h·ªèi qu·∫£n l√Ω th√¥ng tin chi ti·∫øt cho nhi·ªÅu lo·∫°i ng∆∞·ªùi d√πng v√† ƒë·ªëi t∆∞·ª£ng kinh doanh. D∆∞·ªõi ƒë√¢y l√† c√°c th·ª±c th·ªÉ ch√≠nh v√† thu·ªôc t√≠nh c·ªßa ch√∫ng. Ch·ªçn m·ªôt th·ª±c th·ªÉ t·ª´ danh s√°ch b√™n tr√°i ƒë·ªÉ xem chi ti·∫øt c√°c thu·ªôc t√≠nh v√† m√¥ t·∫£ c·ªßa n√≥.</p>
                <div class="md:flex md:space-x-6">
                    <div class="md:w-1/3 mb-6 md:mb-0">
                        <h3 class="text-lg font-semibold text-sky-600 mb-3">Danh s√°ch th·ª±c th·ªÉ:</h3>
                        <ul id="entityList" class="space-y-2 custom-scrollbar overflow-y-auto max-h-[calc(100vh-250px)] pr-2">
                        </ul>
                    </div>
                    <div id="entityDetail" class="md:w-2/3 p-4 border border-stone-200 rounded-lg bg-stone-50 min-h-[300px]">
                        <p class="text-stone-500 italic">Ch·ªçn m·ªôt th·ª±c th·ªÉ t·ª´ danh s√°ch ƒë·ªÉ xem chi ti·∫øt.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="relationships" class="tab-content bg-white shadow-lg rounded-lg">
             <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">II. M·ªëi Quan H·ªá Gi·ªØa C√°c Th·ª±c Th·ªÉ</h2>
                <p class="mb-4 text-stone-700 leading-relaxed">M·ªëi quan h·ªá l√† x∆∞∆°ng s·ªëng c·ªßa c∆° s·ªü d·ªØ li·ªáu quan h·ªá, ƒë·ªãnh nghƒ©a c√°ch c√°c th·ª±c th·ªÉ t∆∞∆°ng t√°c. Vi·ªác thi·∫øt l·∫≠p m·ªëi quan h·ªá ch√≠nh x√°c l√† r·∫•t quan tr·ªçng ƒë·ªÉ duy tr√¨ t√≠nh to√†n v·∫πn d·ªØ li·ªáu v√† cho ph√©p truy xu·∫•t th√¥ng tin hi·ªáu qu·∫£.</p>
                <div class="mb-6 p-4 border border-stone-200 rounded-lg bg-stone-50">
                    <h3 class="text-xl font-semibold text-sky-600 mb-3">2.1. C√°c lo·∫°i m·ªëi quan h·ªá</h3>
                    <ul class="list-disc list-inside space-y-3 text-stone-700">
                        <li><strong>M·ªôt-m·ªôt (One-to-One - 1:1):</strong> M·ªói b·∫£n ghi ·ªü B·∫£ng A li√™n k·∫øt v·ªõi m·ªôt b·∫£n ghi ·ªü B·∫£ng B, v√† ng∆∞·ª£c l·∫°i. V√≠ d·ª•: `Users` v√† `User_Profiles` (n·∫øu th√¥ng tin h·ªì s∆° l·ªõn/nh·∫°y c·∫£m).</li>
                        <li><strong>M·ªôt-nhi·ªÅu (One-to-Many - 1:N):</strong> M·ªôt b·∫£n ghi ·ªü B·∫£ng A li√™n k·∫øt v·ªõi nhi·ªÅu b·∫£n ghi ·ªü B·∫£ng B, nh∆∞ng m·ªói b·∫£n ghi ·ªü B·∫£ng B ch·ªâ li√™n k·∫øt v·ªõi m·ªôt ·ªü B·∫£ng A. V√≠ d·ª•: M·ªôt `Kh√°ch h√†ng` c√≥ nhi·ªÅu `ƒê∆°n h√†ng`.</li>
                        <li><strong>Nhi·ªÅu-nhi·ªÅu (Many-to-Many - M:N):</strong> Nhi·ªÅu b·∫£n ghi ·ªü B·∫£ng A li√™n k·∫øt v·ªõi nhi·ªÅu b·∫£n ghi ·ªü B·∫£ng B, v√† ng∆∞·ª£c l·∫°i. C·∫ßn b·∫£ng trung gian. V√≠ d·ª•: `S·∫£n ph·∫©m` v√† `ƒê∆°n h√†ng` (th√¥ng qua `Chi ti·∫øt ƒê∆°n h√†ng`).</li>
                    </ul>
                </div>
                <div class="md:flex md:space-x-6">
                    <div class="md:w-1/3 mb-6 md:mb-0">
                        <h3 class="text-lg font-semibold text-sky-600 mb-3">Danh s√°ch m·ªëi quan h·ªá:</h3>
                        <ul id="relationshipList" class="space-y-2 custom-scrollbar overflow-y-auto max-h-[calc(100vh-400px)] pr-2">
                        </ul>
                    </div>
                    <div id="relationshipDetail" class="md:w-2/3 p-4 border border-stone-200 rounded-lg bg-stone-50 min-h-[200px]">
                        <p class="text-stone-500 italic">Ch·ªçn m·ªôt m·ªëi quan h·ªá t·ª´ danh s√°ch ƒë·ªÉ xem chi ti·∫øt.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="constraints" class="tab-content bg-white shadow-lg rounded-lg">
            <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">III. R√†ng Bu·ªôc (Constraints) trong C∆° S·ªü D·ªØ Li·ªáu SQL</h2>
                <p class="mb-6 text-stone-700 leading-relaxed">C√°c r√†ng bu·ªôc trong SQL l√† nh·ªØng quy t·∫Øc ƒë∆∞·ª£c √°p d·ª•ng cho c√°c c·ªôt ho·∫∑c b·∫£ng trong c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ gi·ªõi h·∫°n lo·∫°i d·ªØ li·ªáu c√≥ th·ªÉ ƒë∆∞·ª£c l∆∞u tr·ªØ, ƒë·∫£m b·∫£o t√≠nh ch√≠nh x√°c, to√†n v·∫πn v√† ƒë√°ng tin c·∫≠y c·ªßa d·ªØ li·ªáu. Ch√∫ng gi√∫p ngƒÉn ch·∫∑n vi·ªác nh·∫≠p d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng nh·∫•t qu√°n.</p>
                <div id="constraintsList" class="space-y-6">
                </div>
            </div>
        </div>

        <div id="expiration-repurpose" class="tab-content bg-white shadow-lg rounded-lg">
            <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">IV. Qu·∫£n L√Ω H·∫°n S·ª≠ D·ª•ng & T√°i Ch·∫ø S·∫£n Ph·∫©m</h2>
                <p class="mb-4 text-stone-700 leading-relaxed">Trong m·ªôt s·ªë ng√†nh h√†ng nh∆∞ th·ª±c ph·∫©m, d∆∞·ª£c ph·∫©m, vi·ªác qu·∫£n l√Ω h·∫°n s·ª≠ d·ª•ng (HSD) c·ªßa s·∫£n ph·∫©m l√† r·∫•t quan tr·ªçng. ƒê·ªìng th·ªùi, kh·∫£ nƒÉng t√°i ch·∫ø ho·∫∑c chuy·ªÉn ƒë·ªïi s·∫£n ph·∫©m g·∫ßn h·∫øt h·∫°n th√†nh m·ªôt d·∫°ng s·∫£n ph·∫©m kh√°c (v√≠ d·ª•: c√† r·ªët t∆∞∆°i th√†nh n∆∞·ªõc √©p c√† r·ªët) c√≥ th·ªÉ gi√∫p gi·∫£m thi·ªÉu l√£ng ph√≠ v√† t·ªëi ∆∞u h√≥a gi√° tr·ªã. Ph·∫ßn n√†y s·∫Ω th·∫£o lu·∫≠n v·ªÅ c√°ch m·ªü r·ªông m√¥ h√¨nh c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ gi·∫£i quy·∫øt c√°c y√™u c·∫ßu n√†y.</p>

                <div class="mb-8 p-6 border border-amber-300 rounded-lg bg-amber-50 shadow">
                    <h3 class="text-xl font-semibold text-amber-700 mb-3" id="problem-title"></h3>
                    <p class="text-stone-700 leading-relaxed" id="problem-description"></p>
                </div>

                <div class="mb-8">
                    <h3 class="text-xl font-semibold text-sky-600 mb-3" id="expiration-solution-title"></h3>
                    <p class="mb-4 text-stone-700 leading-relaxed" id="expiration-solution-description"></p>
                    <div class="p-4 border border-emerald-200 rounded-lg bg-emerald-50">
                        <h4 class="text-lg font-semibold text-emerald-700 mb-2" id="products-hsd-table-name"></h4>
                        <div class="overflow-x-auto shadow rounded-md">
                            <table class="min-w-full bg-white border border-stone-200">
                                <thead class="bg-stone-100">
                                    <tr>
                                        <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">T√™n Thu·ªôc T√≠nh</th>
                                        <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">Lo·∫°i (PK/FK/CHECK)</th>
                                        <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">M√¥ T·∫£</th>
                                    </tr>
                                </thead>
                                <tbody id="products-hsd-attributes" class="divide-y divide-stone-200"></tbody>
                            </table>
                        </div>
                        <p class="mt-4 text-sm text-stone-600 leading-relaxed" id="expiration-solution-explanation"></p>
                    </div>
                </div>

                <div class="mb-8">
                    <h3 class="text-xl font-semibold text-sky-600 mb-3" id="repurposing-solution-title"></h3>
                    <p class="mb-4 text-stone-700 leading-relaxed" id="repurposing-solution-description"></p>
                    <div class="p-4 border border-emerald-200 rounded-lg bg-emerald-50">
                        <h4 class="text-lg font-semibold text-emerald-700 mb-2" id="product-transformation-table-name"></h4>
                        <div class="overflow-x-auto shadow rounded-md">
                            <table class="min-w-full bg-white border border-stone-200">
                                <thead class="bg-stone-100">
                                    <tr>
                                        <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">T√™n Thu·ªôc T√≠nh</th>
                                        <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">Lo·∫°i (PK/FK)</th>
                                        <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">M√¥ T·∫£</th>
                                    </tr>
                                </thead>
                                <tbody id="product-transformation-attributes" class="divide-y divide-stone-200"></tbody>
                            </table>
                        </div>
                        <p class="mt-4 text-sm text-stone-600 leading-relaxed" id="repurposing-solution-explanation"></p>
                    </div>
                </div>

                <div class="p-6 border border-rose-300 rounded-lg bg-rose-50 shadow">
                    <h3 class="text-xl font-semibold text-rose-700 mb-3" id="need-for-new-tables-title"></h3>
                    <p class="text-stone-700 leading-relaxed" id="need-for-new-tables-explanation"></p>
                </div>
            </div>
        </div>

        <div id="product-reviews" class="tab-content bg-white shadow-lg rounded-lg">
            <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">V. ƒê√°nh Gi√° S·∫£n Ph·∫©m (Product Reviews)</h2>
                <p class="mb-4 text-stone-700 leading-relaxed">H·ªá th·ªëng ƒë√°nh gi√° s·∫£n ph·∫©m l√† m·ªôt t√≠nh nƒÉng quan tr·ªçng gi√∫p ng∆∞·ªùi mua ƒë∆∞a ra quy·∫øt ƒë·ªãnh th√¥ng minh v√† cung c·∫•p ph·∫£n h·ªìi c√≥ gi√° tr·ªã cho ng∆∞·ªùi b√°n. ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh x√°c th·ª±c, ch·ªâ nh·ªØng ng∆∞·ªùi d√πng ƒë√£ mua s·∫£n ph·∫©m m·ªõi c√≥ th·ªÉ ƒë√°nh gi√°.</p>
                <div class="p-4 border border-emerald-200 rounded-lg bg-emerald-50 shadow">
                    <h3 class="text-xl font-semibold text-emerald-700 mb-3">Th·ª±c th·ªÉ: `ProductReviews`</h3>
                    <p class="mb-4 text-stone-700 leading-relaxed">B·∫£ng n√†y l∆∞u tr·ªØ th√¥ng tin v·ªÅ c√°c ƒë√°nh gi√° s·∫£n ph·∫©m t·ª´ ng∆∞·ªùi d√πng.</p>
                    <div class="overflow-x-auto shadow rounded-md">
                        <table class="min-w-full bg-white border border-stone-200">
                            <thead class="bg-stone-100">
                                <tr>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">T√™n Thu·ªôc T√≠nh</th>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">Lo·∫°i (PK/FK/R√†ng bu·ªôc)</th>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">M√¥ T·∫£</th>
                                </tr>
                            </thead>
                            <tbody id="product-reviews-attributes" class="divide-y divide-stone-200">
                                </tbody>
                        </table>
                    </div>
                    <p class="mt-4 text-sm text-stone-600 leading-relaxed">
                        <strong>C√°ch ho·∫°t ƒë·ªông:</strong>
                        <ul class="list-disc list-inside ml-4 space-y-1">
                            <li>Khi ng∆∞·ªùi d√πng mua m·ªôt s·∫£n ph·∫©m trong m·ªôt ƒë∆°n h√†ng, m·ªôt b·∫£n ghi `OrderItem` ƒë∆∞·ª£c t·∫°o.</li>
                            <li>Ng∆∞·ªùi d√πng ch·ªâ c√≥ th·ªÉ t·∫°o ƒë√°nh gi√° cho m·ªôt `ProductID` c·ª• th·ªÉ th√¥ng qua m·ªôt `OrderItemID` ƒë√£ mua. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng ƒë√°nh gi√° l√† h·ª£p l·ªá v√† li√™n quan ƒë·∫øn m·ªôt giao d·ªãch mua th·ª±c t·∫ø.</li>
                            <li>R√†ng bu·ªôc `UNIQUE (OrderItemID)` ƒë·∫£m b·∫£o m·ªói m·ª•c s·∫£n ph·∫©m trong ƒë∆°n h√†ng ch·ªâ ƒë∆∞·ª£c ƒë√°nh gi√° m·ªôt l·∫ßn.</li>
                            <li>Tr·∫°ng th√°i `Status` gi√∫p qu·∫£n tr·ªã vi√™n ki·ªÉm duy·ªát ƒë√°nh gi√° tr∆∞·ªõc khi hi·ªÉn th·ªã c√¥ng khai.</li>
                        </ul>
                    </p>
                </div>
            </div>
        </div>

        <div id="promotions-coupons" class="tab-content bg-white shadow-lg rounded-lg">
            <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">VI. Khuy·∫øn M√£i (Sales) & M√£ Gi·∫£m Gi√° (Coupons)</h2>
                <p class="mb-4 text-stone-700 leading-relaxed">C√°c ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i v√† m√£ gi·∫£m gi√° l√† c√¥ng c·ª• m·∫°nh m·∫Ω ƒë·ªÉ thu h√∫t kh√°ch h√†ng, tƒÉng doanh s·ªë v√† qu·∫£n l√Ω t·ªìn kho. Ch√∫ng ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ linh ho·∫°t v√† c√≥ th·ªÉ √°p d·ª•ng theo nhi·ªÅu quy t·∫Øc kh√°c nhau.</p>

                <div class="mb-8 p-4 border border-blue-200 rounded-lg bg-blue-50 shadow">
                    <h3 class="text-xl font-semibold text-blue-700 mb-3">Th·ª±c th·ªÉ: `Sales` (Ch∆∞∆°ng Tr√¨nh Gi·∫£m Gi√° Chung)</h3>
                    <p class="mb-4 text-stone-700 leading-relaxed">B·∫£ng n√†y qu·∫£n l√Ω c√°c ch∆∞∆°ng tr√¨nh gi·∫£m gi√° t·ªïng th·ªÉ √°p d·ª•ng cho m·ªôt nh√≥m s·∫£n ph·∫©m ho·∫∑c to√†n b·ªô s√†n.</p>
                    <div class="overflow-x-auto shadow rounded-md">
                        <table class="min-w-full bg-white border border-stone-200">
                            <thead class="bg-stone-100">
                                <tr>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">T√™n Thu·ªôc T√≠nh</th>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">Lo·∫°i (PK/R√†ng bu·ªôc)</th>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">M√¥ T·∫£</th>
                                </tr>
                            </thead>
                            <tbody id="sales-attributes" class="divide-y divide-stone-200">
                                </tbody>
                        </table>
                    </div>
                    <p class="mt-4 text-sm text-stone-600 leading-relaxed">
                        <strong>C√°ch ho·∫°t ƒë·ªông:</strong>
                        <ul class="list-disc list-inside ml-4 space-y-1">
                            <li>`Sales` ƒë·∫°i di·ªán cho c√°c s·ª± ki·ªán gi·∫£m gi√° l·ªõn (v√≠ d·ª•: 'Flash Sale', 'Gi·∫£m gi√° cu·ªëi nƒÉm').</li>
                            <li>`DiscountType` v√† `DiscountValue` x√°c ƒë·ªãnh m·ª©c gi·∫£m gi√°.</li>
                            <li>`CategoryID` cho ph√©p √°p d·ª•ng gi·∫£m gi√° cho m·ªôt danh m·ª•c c·ª• th·ªÉ (ho·∫∑c NULL n·∫øu √°p d·ª•ng cho t·∫•t c·∫£ s·∫£n ph·∫©m).</li>
                            <li>Gi√° cu·ªëi c√πng c·ªßa s·∫£n ph·∫©m tr√™n s√†n s·∫Ω ƒë∆∞·ª£c t√≠nh to√°n d·ª±a tr√™n gi√° g·ªëc v√† c√°c ch∆∞∆°ng tr√¨nh `Sales` ƒëang ho·∫°t ƒë·ªông.</li>
                        </ul>
                    </p>
                </div>

                <div class="p-4 border border-purple-200 rounded-lg bg-purple-50 shadow">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Th·ª±c th·ªÉ: `Coupons` (M√£ Gi·∫£m Gi√°)</h3>
                    <p class="mb-4 text-stone-700 leading-relaxed">B·∫£ng n√†y qu·∫£n l√Ω c√°c m√£ gi·∫£m gi√° c√° nh√¢n ho·∫∑c c√¥ng khai m√† ng∆∞·ªùi d√πng c√≥ th·ªÉ √°p d·ª•ng khi thanh to√°n.</p>
                    <div class="overflow-x-auto shadow rounded-md">
                        <table class="min-w-full bg-white border border-stone-200">
                            <thead class="bg-stone-100">
                                <tr>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">T√™n Thu·ªôc T√≠nh</th>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">Lo·∫°i (PK/R√†ng bu·ªôc)</th>
                                    <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">M√¥ T·∫£</th>
                                </tr>
                            </thead>
                            <tbody id="coupons-attributes" class="divide-y divide-stone-200">
                                </tbody>
                        </table>
                    </div>
                    <p class="mt-4 text-sm text-stone-600 leading-relaxed">
                        <strong>C√°ch ho·∫°t ƒë·ªông:</strong>
                        <ul class="list-disc list-inside ml-4 space-y-1">
                            <li>Ng∆∞·ªùi d√πng nh·∫≠p `Code` c·ªßa coupon khi thanh to√°n.</li>
                            <li>H·ªá th·ªëng ki·ªÉm tra `StartDate`, `ExpirationDate`, `QuantityAvailable`, `UsageLimitPerCustomer` v√† `CategoryID` ƒë·ªÉ x√°c ƒë·ªãnh t√≠nh h·ª£p l·ªá c·ªßa coupon.</li>
                            <li>N·∫øu h·ª£p l·ªá, `DiscountValue` s·∫Ω ƒë∆∞·ª£c √°p d·ª•ng cho ƒë∆°n h√†ng. `IsFreeShipping` s·∫Ω ƒë∆∞·ª£c ki·ªÉm tra ƒë·ªÉ mi·ªÖn ph√≠ v·∫≠n chuy·ªÉn.</li>
                            <li>Khi coupon ƒë∆∞·ª£c s·ª≠ d·ª•ng, `QuantityAvailable` (n·∫øu c√≥) s·∫Ω gi·∫£m v√† l·ªãch s·ª≠ s·ª≠ d·ª•ng c·ªßa kh√°ch h√†ng s·∫Ω ƒë∆∞·ª£c ghi l·∫°i (c√≥ th·ªÉ trong b·∫£ng `User_Coupon_Usage` ri√™ng ho·∫∑c trong b·∫£ng `Orders`).</li>
                        </ul>
                    </p>
                </div>
            </div>
        </div>

        <div id="sql-schema" class="tab-content bg-white shadow-lg rounded-lg">
            <div class="tab-inner-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-6">VII. L∆∞·ª£c ƒê·ªì SQL (SQL Schema)</h2>
                <p class="mb-4 text-stone-700 leading-relaxed">D∆∞·ªõi ƒë√¢y l√† c√°c c√¢u l·ªánh `CREATE TABLE` cho SQL Server, ƒë∆∞·ª£c t·∫°o ra t·ª´ l∆∞·ª£c ƒë·ªì DBML b·∫°n ƒë√£ cung c·∫•p. B·∫°n c√≥ th·ªÉ sao ch√©p v√† s·ª≠ d·ª•ng ch√∫ng ƒë·ªÉ t·∫°o c∆° s·ªü d·ªØ li·ªáu c·ªßa m√¨nh.</p>
                <div class="relative">
                    <button id="copySqlButton" class="absolute top-3 right-3 bg-sky-600 text-white p-2 rounded-md hover:bg-sky-700 transition-colors duration-200 text-sm">Sao ch√©p SQL</button>
                    <pre id="sqlCodeBlock" class="mt-2"></pre>
                </div>
            </div>
        </div>
    </main>

    <footer class="text-center p-4 text-sm text-stone-600 border-t border-stone-200 mt-8">
        ·ª®ng d·ª•ng t∆∞∆°ng t√°c d·ª±a tr√™n b√°o c√°o thi·∫øt k·∫ø CSDL eCommerce.
    </footer>

<script>
const entitiesData = {
    "Roles": {
        name: "Vai tr√≤ (Roles)",
        description: "L∆∞u tr·ªØ c√°c vai tr√≤ ng∆∞·ªùi d√πng kh√°c nhau trong h·ªá th·ªëng (v√≠ d·ª•: Buyer, Seller, Admin).",
        attributes: [
            { name: "RoleID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ªói vai tr√≤." },
            { name: "RoleName", type: "UNIQUE, NOT NULL", details: "T√™n vai tr√≤ (v√≠ d·ª•: 'Buyer', 'Seller', 'Admin')." }
        ]
    },
    "Users": {
        name: "Ng∆∞·ªùi d√πng (Users)",
        description: "L∆∞u tr·ªØ th√¥ng tin chung cho t·∫•t c·∫£ c√°c t√†i kho·∫£n ng∆∞·ªùi d√πng tr√™n n·ªÅn t·∫£ng.",
        attributes: [
            { name: "UserID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ªói ng∆∞·ªùi d√πng." },
            { name: "Username", type: "UNIQUE, NOT NULL", details: "T√™n ƒëƒÉng nh·∫≠p, ph·∫£i l√† duy nh·∫•t." },
            { name: "PasswordHash", type: "NOT NULL", details: "M·∫≠t kh·∫©u ƒë√£ bƒÉm (ƒë·ªÉ b·∫£o m·∫≠t)." },
            { name: "FirstName", type: "", details: "T√™n c·ªßa ng∆∞·ªùi d√πng." },
            { name: "LastName", type: "", details: "H·ªç c·ªßa ng∆∞·ªùi d√πng." },
            { name: "Email", type: "UNIQUE", details: "ƒê·ªãa ch·ªâ email (duy nh·∫•t, d√πng cho ƒëƒÉng nh·∫≠p v√† li√™n h·ªá)." },
            { name: "PhoneNumber", type: "UNIQUE, NOT NULL", details: "S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá (duy nh·∫•t, kh√¥ng r·ªóng)." },
            { name: "DateOfBirth", type: "date", details: "Ng√†y sinh c·ªßa ng∆∞·ªùi d√πng." },
            { name: "ProfilePictureUrl", type: "", details: "ƒê∆∞·ªùng d·∫´n ƒë·∫øn ·∫£nh ƒë·∫°i di·ªán." },
            { name: "RoleID", type: "FK (Roles.RoleID), NOT NULL", details: "Li√™n k·∫øt v·ªõi vai tr√≤ c·ªßa ng∆∞·ªùi d√πng." },
            { name: "RegistrationDate", type: "DEFAULT `getdate()`", details: "Ng√†y ng∆∞·ªùi d√πng ƒëƒÉng k√Ω t√†i kho·∫£n." },
            { name: "LastLoginDate", type: "datetime", details: "Ng√†y ƒëƒÉng nh·∫≠p cu·ªëi c√πng c·ªßa ng∆∞·ªùi d√πng." },
            { name: "Status", type: "DEFAULT 'active', NOT NULL", details: "Tr·∫°ng th√°i t√†i kho·∫£n ('active', 'inactive', 'suspended')." }
        ]
    },
    "Sellers": {
        name: "Ng∆∞·ªùi b√°n (Sellers)",
        description: "M·ªü r·ªông th√¥ng tin cho ng∆∞·ªùi d√πng c√≥ vai tr√≤ l√† ng∆∞·ªùi b√°n, ch·ª©a c√°c thu·ªôc t√≠nh ƒë·∫∑c th√π c·ªßa nh√† cung c·∫•p.",
        attributes: [
            { name: "SellerID", type: "PK, FK (Users.UserID)", details: "M√£ ƒë·ªãnh danh ng∆∞·ªùi b√°n, li√™n k·∫øt v·ªõi Users." },
            { name: "StoreName", type: "NOT NULL", details: "T√™n c·ª≠a h√†ng ho·∫∑c th∆∞∆°ng hi·ªáu." },
            { name: "StoreDescription", type: "text", details: "M√¥ t·∫£ chi ti·∫øt v·ªÅ c·ª≠a h√†ng." },
            { name: "BankAccountDetails", type: "", details: "Th√¥ng tin t√†i kho·∫£n ng√¢n h√†ng (c·∫ßn m√£ h√≥a)." },
            { name: "BusinessLicenseNumber", type: "UNIQUE", details: "S·ªë gi·∫•y ph√©p kinh doanh (n·∫øu c√≥, ph·∫£i l√† duy nh·∫•t)." },
            { name: "SellerRating", type: "decimal(2,1), DEFAULT 0", details: "ƒêi·ªÉm ƒë√°nh gi√° trung b√¨nh (0-5)." },
            { name: "JoinDate", type: "DEFAULT `getdate()`", details: "Ng√†y ng∆∞·ªùi b√°n tham gia." },
            { name: "IsVerified", type: "boolean, DEFAULT false", details: "Tr·∫°ng th√°i x√°c minh t√†i kho·∫£n ng∆∞·ªùi b√°n." }
        ]
    },
    "Cities": {
        name: "Th√†nh ph·ªë (Cities)",
        description: "L∆∞u tr·ªØ danh s√°ch c√°c th√†nh ph·ªë/t·ªânh th√†nh.",
        attributes: [
            { name: "CityID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho th√†nh ph·ªë." },
            { name: "CityName", type: "UNIQUE, NOT NULL", details: "T√™n th√†nh ph·ªë." }
        ]
    },
    "Districts": {
        name: "Qu·∫≠n/Huy·ªán (Districts)",
        description: "L∆∞u tr·ªØ danh s√°ch c√°c qu·∫≠n/huy·ªán thu·ªôc v·ªÅ m·ªôt th√†nh ph·ªë.",
        attributes: [
            { name: "DistrictID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho qu·∫≠n/huy·ªán." },
            { name: "CityID", type: "FK (Cities.CityID), NOT NULL", details: "Li√™n k·∫øt v·ªõi th√†nh ph·ªë." },
            { name: "DistrictName", type: "NOT NULL", details: "T√™n qu·∫≠n/huy·ªán." }
        ]
    },
    "Addresses": {
        name: "ƒê·ªãa ch·ªâ (Addresses)",
        description: "L∆∞u tr·ªØ ƒë·ªãa ch·ªâ thanh to√°n v√† giao h√†ng c·ªßa kh√°ch h√†ng.",
        attributes: [
            { name: "AddressID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho ƒë·ªãa ch·ªâ." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Li√™n k·∫øt v·ªõi ng∆∞·ªùi d√πng s·ªü h·ªØu ƒë·ªãa ch·ªâ." },
            { name: "StreetAddress", type: "NOT NULL", details: "S·ªë nh√†, t√™n ƒë∆∞·ªùng." },
            { name: "CityID", type: "FK (Cities.CityID), NOT NULL", details: "Li√™n k·∫øt v·ªõi th√†nh ph·ªë." },
            { name: "DistrictID", type: "FK (Districts.DistrictID), NOT NULL", details: "Li√™n k·∫øt v·ªõi qu·∫≠n/huy·ªán." },
            { name: "AddressType", type: "NOT NULL, DEFAULT 'shipping'", details: "Lo·∫°i ƒë·ªãa ch·ªâ ('shipping', 'billing', 'home', 'work')." },
            { name: "IsDefault", type: "boolean, DEFAULT false", details: "C·ªù ch·ªâ ƒë·ªãnh ƒë·ªãa ch·ªâ m·∫∑c ƒë·ªãnh." }
        ]
    },
    "Categories": {
        name: "Danh m·ª•c (Categories)",
        description: "T·ªï ch·ª©c c√°c danh m·ª•c s·∫£n ph·∫©m, gi√∫p ng∆∞·ªùi d√πng d·ªÖ d√†ng ƒëi·ªÅu h∆∞·ªõng.",
        attributes: [
            { name: "CategoryID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho danh m·ª•c." },
            { name: "Name", type: "UNIQUE, NOT NULL", details: "T√™n danh m·ª•c, ph·∫£i l√† duy nh·∫•t." },
            { name: "Description", type: "text", details: "M√¥ t·∫£ danh m·ª•c." },
            { name: "ParentCategoryID", type: "FK (Categories.CategoryID)", details: "Cho ph√©p c·∫•u tr√∫c danh m·ª•c ph√¢n c·∫•p (c√≥ th·ªÉ NULL)." }
        ]
    },
    "Products": {
        name: "S·∫£n ph·∫©m (Products)",
        description: "L∆∞u tr·ªØ th√¥ng tin chi ti·∫øt c·ªßa t·∫•t c·∫£ c√°c s·∫£n ph·∫©m ƒë∆∞·ª£c b√°n tr√™n n·ªÅn t·∫£ng.",
        attributes: [
            { name: "ProductID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho s·∫£n ph·∫©m." },
            { name: "SellerID", type: "FK (Sellers.SellerID), NOT NULL", details: "Li√™n k·∫øt s·∫£n ph·∫©m v·ªõi ng∆∞·ªùi b√°n." },
            { name: "CategoryID", type: "FK (Categories.CategoryID), NOT NULL", details: "Li√™n k·∫øt s·∫£n ph·∫©m v·ªõi danh m·ª•c." },
            { name: "Name", type: "NOT NULL", details: "T√™n s·∫£n ph·∫©m." },
            { name: "Description", type: "text", details: "M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m." },
            { name: "Price", type: "decimal(18,2), NOT NULL", details: "Gi√° b√°n c·ªßa s·∫£n ph·∫©m." },
            { name: "StockQuantity", type: "default: 0", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m c√≤n trong kho." },
            { name: "Unit", type: "", details: "ƒê∆°n v·ªã t√≠nh c·ªßa s·∫£n ph·∫©m (v√≠ d·ª•: 'c√°i', 'kg', 'l√≠t')." },
            { name: "ImageUrl", type: "", details: "ƒê∆∞·ªùng d·∫´n ƒë·∫øn h√¨nh ·∫£nh ch√≠nh c·ªßa s·∫£n ph·∫©m." },
            { name: "Status", type: "NOT NULL, default: 'available'", details: "Tr·∫°ng th√°i s·∫£n ph·∫©m ('available', 'out_of_stock', 'discontinued', 'hidden')." },
            { name: "IsRecyclable", type: "boolean, default: false", details: "C·ªù ch·ªâ ƒë·ªãnh s·∫£n ph·∫©m c√≥ th·ªÉ t√°i ch·∫ø/chuy·ªÉn ƒë·ªïi th√†nh s·∫£n ph·∫©m kh√°c hay kh√¥ng." },
            { name: "ImportDate", type: "date", details: "Ng√†y nh·∫≠p s·∫£n ph·∫©m v√†o kho." },
            { name: "ExpirationDate", type: "date", details: "Ng√†y h·∫øt h·∫°n c·ªßa s·∫£n ph·∫©m." },
            { name: "CreatedAt", type: "default: `getdate()`", details: "Th·ªùi gian t·∫°o b·∫£n ghi." },
            { name: "UpdatedAt", type: "default: `getdate()`", details: "Th·ªùi gian c·∫≠p nh·∫≠t b·∫£n ghi." }
        ]
    },
    "ProductImages": {
        name: "H√¨nh ·∫£nh S·∫£n ph·∫©m (ProductImages)",
        description: "L∆∞u tr·ªØ c√°c h√¨nh ·∫£nh b·ªï sung cho m·ªói s·∫£n ph·∫©m.",
        attributes: [
            { name: "ImageID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho h√¨nh ·∫£nh." },
            { name: "ProductID", type: "FK (Products.ProductID), NOT NULL", details: "Li√™n k·∫øt h√¨nh ·∫£nh v·ªõi s·∫£n ph·∫©m." },
            { name: "ImageUrl", type: "NOT NULL", details: "ƒê∆∞·ªùng d·∫´n ƒë·∫øn h√¨nh ·∫£nh." }
        ]
    },
    "ShoppingCarts": {
        name: "Gi·ªè h√†ng (ShoppingCarts)",
        description: "L∆∞u tr·ªØ th√¥ng tin v·ªÅ gi·ªè h√†ng c·ªßa ng∆∞·ªùi d√πng.",
        attributes: [
            { name: "CartID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho gi·ªè h√†ng." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Li√™n k·∫øt gi·ªè h√†ng v·ªõi ng∆∞·ªùi d√πng." },
            { name: "CreatedAt", type: "default: `getdate()`", details: "Th·ªùi gian t·∫°o gi·ªè h√†ng." },
            { name: "UpdatedAt", type: "datetime", details: "Th·ªùi gian c·∫≠p nh·∫≠t gi·ªè h√†ng l·∫ßn cu·ªëi." }
        ]
    },
    "CartItems": {
        name: "M·ª•c trong Gi·ªè h√†ng (CartItems)",
        description: "L∆∞u tr·ªØ c√°c s·∫£n ph·∫©m v√† s·ªë l∆∞·ª£ng trong m·ªói gi·ªè h√†ng.",
        attributes: [
            { name: "CartItemID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ª•c trong gi·ªè h√†ng." },
            { name: "CartID", type: "FK (ShoppingCarts.CartID), NOT NULL", details: "Li√™n k·∫øt v·ªõi gi·ªè h√†ng." },
            { name: "ProductID", type: "FK (Products.ProductID), NOT NULL", details: "Li√™n k·∫øt v·ªõi s·∫£n ph·∫©m." },
            { name: "Quantity", type: "NOT NULL", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong m·ª•c n√†y." },
            { name: "AddedAt", type: "default: `getdate()`", details: "Th·ªùi gian s·∫£n ph·∫©m ƒë∆∞·ª£c th√™m v√†o gi·ªè h√†ng." }
        ]
    },
    "Wishlists": {
        name: "Danh s√°ch y√™u th√≠ch (Wishlists)",
        description: "L∆∞u tr·ªØ danh s√°ch y√™u th√≠ch c·ªßa ng∆∞·ªùi d√πng, bao g·ªìm s·∫£n ph·∫©m v√† th·ªùi gian th√™m. M·ªói c·∫∑p UserID-ProductID l√† duy nh·∫•t.",
        attributes: [
            { name: "WishlistID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ª•c trong danh s√°ch y√™u th√≠ch." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Li√™n k·∫øt danh s√°ch y√™u th√≠ch v·ªõi ng∆∞·ªùi d√πng." },
            { name: "ProductID", type: "FK (Products.ProductID), NOT NULL", details: "Li√™n k·∫øt v·ªõi s·∫£n ph·∫©m ƒë∆∞·ª£c th√™m v√†o danh s√°ch y√™u th√≠ch." },
            { name: "AddedAt", type: "default: `getdate()`", details: "Th·ªùi gian s·∫£n ph·∫©m ƒë∆∞·ª£c th√™m v√†o danh s√°ch y√™u th√≠ch." }
        ]
    },
    "DeliveryPartners": {
        name: "ƒê·ªëi t√°c V·∫≠n chuy·ªÉn (DeliveryPartners)",
        description: "L∆∞u tr·ªØ th√¥ng tin v·ªÅ c√°c ƒë·ªëi t√°c v·∫≠n chuy·ªÉn c·ªßa s√†n.",
        attributes: [
            { name: "PartnerID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho ƒë·ªëi t√°c v·∫≠n chuy·ªÉn." },
            { name: "Name", type: "UNIQUE, NOT NULL", details: "T√™n ƒë·ªëi t√°c v·∫≠n chuy·ªÉn." },
            { name: "ContactPerson", type: "", details: "Ng∆∞·ªùi li√™n h·ªá c·ªßa ƒë·ªëi t√°c." },
            { name: "PhoneNumber", type: "UNIQUE", details: "S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá (duy nh·∫•t)." },
            { name: "Email", type: "UNIQUE", details: "ƒê·ªãa ch·ªâ email (duy nh·∫•t)." },
            { name: "ServiceArea", type: "text", details: "Khu v·ª±c ho·∫°t ƒë·ªông c·ªßa ƒë·ªëi t√°c." },
            { name: "Rating", type: "decimal(2,1)", details: "ƒê√°nh gi√° trung b√¨nh c·ªßa ƒë·ªëi t√°c (0-5)." },
            { name: "CreatedAt", type: "default: `getdate()`", details: "Th·ªùi gian t·∫°o b·∫£n ghi." }
        ]
    },
    "Orders": {
        name: "ƒê∆°n h√†ng (Orders)",
        description: "Qu·∫£n l√Ω v√† x·ª≠ l√Ω ƒë∆°n h√†ng c·ªßa kh√°ch h√†ng.",
        attributes: [
            { name: "OrderID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ªói ƒë∆°n h√†ng." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Li√™n k·∫øt ƒë∆°n h√†ng v·ªõi ng∆∞·ªùi d√πng ƒë·∫∑t h√†ng." },
            { name: "OrderDate", type: "default: `getdate()`", details: "Ng√†y v√† gi·ªù ƒë·∫∑t h√†ng." },
            { name: "TotalAmount", type: "decimal(18,2), NOT NULL", details: "T·ªïng gi√° tr·ªã c·ªßa ƒë∆°n h√†ng." },
            { name: "Status", type: "default: 'pending', NOT NULL", details: "Tr·∫°ng th√°i ƒë∆°n h√†ng ('pending', 'processing', 'shipped', 'delivered', 'cancelled', 'refunded')." },
            { name: "ShippingAddressID", type: "FK (Addresses.AddressID), NOT NULL", details: "ƒê·ªãa ch·ªâ giao h√†ng." },
            { name: "BillingAddressID", type: "FK (Addresses.AddressID), NOT NULL", details: "ƒê·ªãa ch·ªâ thanh to√°n." },
            { name: "DeliveryPartnerID", type: "FK (DeliveryPartners.PartnerID)", details: "ƒê·ªëi t√°c v·∫≠n chuy·ªÉn ch·ªãu tr√°ch nhi·ªám." },
            { name: "DeliveryInstructions", type: "", details: "H∆∞·ªõng d·∫´n giao h√†ng ƒë·∫∑c bi·ªát." },
            { name: "EstimatedDeliveryDate", type: "date", details: "Ng√†y giao h√†ng d·ª± ki·∫øn." },
            { name: "ActualDeliveryDate", type: "date", details: "Ng√†y giao h√†ng th·ª±c t·∫ø." },
            { name: "PaymentMethodID", type: "FK (PaymentMethods.MethodID)", details: "Ph∆∞∆°ng th·ª©c thanh to√°n ƒë∆∞·ª£c s·ª≠ d·ª•ng." },
            { name: "Notes", type: "text", details: "Ghi ch√∫ th√™m v·ªÅ ƒë∆°n h√†ng." }
        ]
    },
    "OrderItems": {
        name: "M·ª•c trong ƒê∆°n h√†ng (OrderItems)",
        description: "Ch·ª©a th√¥ng tin chi ti·∫øt c·ªßa t·ª´ng m·∫∑t h√†ng trong m·ªôt ƒë∆°n h√†ng.",
        attributes: [
            { name: "OrderItemID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho chi ti·∫øt ƒë∆°n h√†ng." },
            { name: "OrderID", type: "FK (Orders.OrderID), NOT NULL", details: "Li√™n k·∫øt v·ªõi ƒë∆°n h√†ng." },
            { name: "ProductID", type: "FK (Products.ProductID), NOT NULL", details: "Li√™n k·∫øt v·ªõi s·∫£n ph·∫©m." },
            { name: "Quantity", type: "NOT NULL", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m ƒë·∫∑t." },
            { name: "PriceAtPurchase", type: "decimal(18,2), NOT NULL", details: "Gi√° s·∫£n ph·∫©m t·∫°i th·ªùi ƒëi·ªÉm mua." },
            { name: "SellerID", type: "FK (Sellers.SellerID), NOT NULL", details: "Ng∆∞·ªùi b√°n c·ªßa s·∫£n ph·∫©m n√†y trong ƒë∆°n h√†ng." }
        ]
    },
    "PaymentMethods": {
        name: "Ph∆∞∆°ng th·ª©c Thanh to√°n (PaymentMethods)",
        description: "L∆∞u tr·ªØ th√¥ng tin v·ªÅ c√°c ph∆∞∆°ng th·ª©c thanh to√°n kh√°c nhau ƒë∆∞·ª£c h·ªó tr·ª£.",
        attributes: [
            { name: "MethodID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t." },
            { name: "Name", type: "UNIQUE, NOT NULL", details: "T√™n ph∆∞∆°ng th·ª©c (v√≠ d·ª•: 'Credit Card', 'PayPal')." },
            { name: "Description", type: "text", details: "M√¥ t·∫£ chi ti·∫øt." },
            { name: "IsActive", type: "boolean, default: true", details: "C·ªù ch·ªâ ƒë·ªãnh ph∆∞∆°ng th·ª©c c√≥ ho·∫°t ƒë·ªông kh√¥ng." }
        ]
    },
    "Payments": {
        name: "Thanh to√°n (Payments)",
        description: "L∆∞u tr·ªØ th√¥ng tin chi ti·∫øt v·ªÅ t·ª´ng giao d·ªãch thanh to√°n th·ª±c t·∫ø.",
        attributes: [
            { name: "PaymentID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho giao d·ªãch." },
            { name: "OrderID", type: "FK (Orders.OrderID), UNIQUE, NOT NULL", details: "Li√™n k·∫øt v·ªõi ƒë∆°n h√†ng (th∆∞·ªùng l√† 1:1 v·ªõi Order)." },
            { name: "MethodID", type: "FK (PaymentMethods.MethodID), NOT NULL", details: "Ph∆∞∆°ng th·ª©c thanh to√°n s·ª≠ d·ª•ng." },
            { name: "Amount", type: "decimal(18,2), NOT NULL", details: "S·ªë ti·ªÅn ƒë√£ thanh to√°n." },
            { name: "PaymentDate", type: "default: `getdate()`", details: "Ng√†y v√† gi·ªù thanh to√°n." },
            { name: "Status", type: "default: 'pending', NOT NULL", details: "Tr·∫°ng th√°i thanh to√°n ('pending', 'completed', 'failed', 'refunded')." },
            { name: "TransactionIDGateway", type: "UNIQUE", details: "M√£ giao d·ªãch t·ª´ c·ªïng thanh to√°n (n·∫øu c√≥, th∆∞·ªùng l√† duy nh·∫•t)." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Ng∆∞·ªùi d√πng th·ª±c hi·ªán thanh to√°n." }
        ]
    },
    "ProductTransformations": {
        name: "Chuy·ªÉn ƒê·ªïi S·∫£n Ph·∫©m (ProductTransformations)",
        description: "Ghi l·∫°i c√°c giao d·ªãch chuy·ªÉn ƒë·ªïi s·∫£n ph·∫©m, ƒë·∫∑c bi·ªát l√† t·ª´ s·∫£n ph·∫©m g·ªëc sang s·∫£n ph·∫©m t√°i ch·∫ø/m·ªõi.",
        attributes: [
            { name: "TransformationID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ªói giao d·ªãch chuy·ªÉn ƒë·ªïi." },
            { name: "SourceProductID", type: "FK (Products.ProductID), NOT NULL", details: "S·∫£n ph·∫©m g·ªëc ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi." },
            { name: "SourceImportDate", type: "date", details: "Ng√†y nh·∫≠p c·ªßa s·∫£n ph·∫©m g·ªëc (ƒë·ªÉ tham chi·∫øu l√¥ c·ª• th·ªÉ n·∫øu c·∫ßn)." },
            { name: "SourceExpirationDate", type: "date", details: "Ng√†y h·∫øt h·∫°n c·ªßa s·∫£n ph·∫©m g·ªëc (ƒë·ªÉ tham chi·∫øu l√¥ c·ª• th·ªÉ n·∫øu c·∫ßn)." },
            { name: "QuantityTransformed", type: "NOT NULL", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m g·ªëc ƒë√£ s·ª≠ d·ª•ng trong qu√° tr√¨nh chuy·ªÉn ƒë·ªïi." },
            { name: "DerivedProductID", type: "FK (Products.ProductID), NOT NULL", details: "S·∫£n ph·∫©m m·ªõi ƒë∆∞·ª£c t·∫°o ra sau chuy·ªÉn ƒë·ªïi (c≈©ng l√† m·ªôt Product trong b·∫£ng Products)." },
            { name: "DerivedQuantityProduced", type: "NOT NULL", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m m·ªõi ƒë∆∞·ª£c t·∫°o ra." },
            { name: "TransformationDate", type: "default: `getdate()`", details: "Ng√†y v√† gi·ªù th·ª±c hi·ªán chuy·ªÉn ƒë·ªïi." },
            { name: "TransformedByUserID", type: "FK (Users.UserID)", details: "Ng∆∞·ªùi d√πng (admin/seller) th·ª±c hi·ªán chuy·ªÉn ƒë·ªïi." },
            { name: "Notes", type: "text", details: "Ghi ch√∫ th√™m v·ªÅ qu√° tr√¨nh chuy·ªÉn ƒë·ªïi." }
        ]
    },
    "ProductReviews": {
        name: "ƒê√°nh Gi√° S·∫£n Ph·∫©m (ProductReviews)",
        description: "L∆∞u tr·ªØ c√°c ƒë√°nh gi√° v√† x·∫øp h·∫°ng c·ªßa ng∆∞·ªùi d√πng cho t·ª´ng s·∫£n ph·∫©m ƒë√£ mua.",
        attributes: [
            { name: "ReviewID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho ƒë√°nh gi√°." },
            { name: "ProductID", type: "FK (Products.ProductID), NOT NULL", details: "S·∫£n ph·∫©m ƒë∆∞·ª£c ƒë√°nh gi√°." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Ng∆∞·ªùi d√πng ƒë√£ th·ª±c hi·ªán ƒë√°nh gi√°." },
            { name: "OrderItemID", type: "FK (OrderItems.OrderItemID), UNIQUE, NOT NULL", details: "M·ª•c ƒë∆°n h√†ng c·ª• th·ªÉ m√† s·∫£n ph·∫©m ƒë∆∞·ª£c mua. ƒê·∫£m b·∫£o ng∆∞·ªùi d√πng ch·ªâ ƒë√°nh gi√° s·∫£n ph·∫©m ƒë√£ mua v√† m·ªói m·ª•c ƒë∆°n h√†ng ch·ªâ ƒë∆∞·ª£c ƒë√°nh gi√° m·ªôt l·∫ßn." },
            { name: "Rating", type: "NOT NULL", details: "ƒêi·ªÉm ƒë√°nh gi√° (1-5 sao)." },
            { name: "Comment", type: "text", details: "N·ªôi dung b√¨nh lu·∫≠n c·ªßa ƒë√°nh gi√°." },
            { name: "ReviewDate", type: "default: `getdate()`", details: "Ng√†y v√† gi·ªù ƒë√°nh gi√°." },
            { name: "Status", type: "default: 'pending', NOT NULL", details: "Tr·∫°ng th√°i ƒë√°nh gi√° ('pending', 'approved', 'rejected')." }
        ]
    },
    "Sales": {
        name: "Ch∆∞∆°ng Tr√¨nh Gi·∫£m Gi√° (Sales)",
        description: "Qu·∫£n l√Ω c√°c ch∆∞∆°ng tr√¨nh gi·∫£m gi√° t·ªïng th·ªÉ √°p d·ª•ng cho s·∫£n ph·∫©m tr√™n s√†n. Gi·ªù ƒë√¢y li√™n k·∫øt tr·ª±c ti·∫øp v·ªõi m·ªôt danh m·ª•c c·ª• th·ªÉ.",
        attributes: [
            { name: "SaleID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho ch∆∞∆°ng tr√¨nh gi·∫£m gi√°." },
            { name: "Name", type: "NOT NULL", details: "T√™n ch∆∞∆°ng tr√¨nh gi·∫£m gi√° (v√≠ d·ª•: 'Black Friday Sale')." },
            { name: "Description", type: "text", details: "M√¥ t·∫£ chi ti·∫øt ch∆∞∆°ng tr√¨nh." },
            { name: "DiscountType", type: "NOT NULL", details: "Lo·∫°i gi·∫£m gi√° ('percentage', 'fixed_amount')." },
            { name: "DiscountValue", type: "decimal(18,2), NOT NULL", details: "Gi√° tr·ªã gi·∫£m gi√° (v√≠ d·ª•: 0.10 cho 10%, 50000 cho 50.000 VNƒê)." },
            { name: "StartDate", type: "NOT NULL", details: "Ng√†y b·∫Øt ƒë·∫ßu ch∆∞∆°ng tr√¨nh." },
            { name: "EndDate", type: "NOT NULL", details: "Ng√†y k·∫øt th√∫c ch∆∞∆°ng tr√¨nh." },
            { name: "CategoryID", type: "FK (Categories.CategoryID), NULL", details: "Danh m·ª•c √°p d·ª•ng gi·∫£m gi√° (NULL n·∫øu √°p d·ª•ng cho t·∫•t c·∫£ s·∫£n ph·∫©m)." },
            { name: "Status", type: "default: 'active', NOT NULL", details: "Tr·∫°ng th√°i ch∆∞∆°ng tr√¨nh ('active', 'inactive', 'scheduled', 'ended')." },
            { name: "CreatedAt", type: "default: `getdate()`", details: "Th·ªùi gian t·∫°o b·∫£n ghi." }
        ]
    },
    "Shipments": {
        name: "V·∫≠n chuy·ªÉn (Shipments)",
        description: "Theo d√µi th√¥ng tin chi ti·∫øt v·ªÅ t·ª´ng l√¥ h√†ng ƒë∆∞·ª£c giao t·ª´ ƒë∆°n h√†ng ƒë·∫øn ng∆∞·ªùi nh·∫≠n.",
        attributes: [
            { name: "ShipmentID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ªói l√¥ h√†ng." },
            { name: "OrderID", type: "FK (Orders.OrderID), NOT NULL", details: "ƒê∆°n h√†ng ƒë∆∞·ª£c v·∫≠n chuy·ªÉn." },
            { name: "DeliveryPartnerID", type: "FK (DeliveryPartners.PartnerID)", details: "ƒê·ªëi t√°c v·∫≠n chuy·ªÉn ch·ªãu tr√°ch nhi·ªám." },
            { name: "TrackingNumber", type: "UNIQUE", details: "M√£ theo d√µi l√¥ h√†ng (duy nh·∫•t)." },
            { name: "ShippingDate", type: "datetime", details: "Ng√†y l√¥ h√†ng ƒë∆∞·ª£c g·ª≠i ƒëi." },
            { name: "EstimatedDeliveryDate", type: "date", details: "Ng√†y giao h√†ng d·ª± ki·∫øn." },
            { name: "ActualDeliveryDate", type: "date", details: "Ng√†y giao h√†ng th·ª±c t·∫ø." },
            { name: "Status", type: "NOT NULL", details: "Tr·∫°ng th√°i v·∫≠n chuy·ªÉn ('pending_pickup', 'in_transit', 'out_for_delivery', 'delivered', 'failed_delivery', 'returned')." },
            { name: "ShippingCost", type: "decimal(10,2)", details: "Chi ph√≠ v·∫≠n chuy·ªÉn." },
            { name: "ShippingAddressID", type: "FK (Addresses.AddressID), NOT NULL", details: "ƒê·ªãa ch·ªâ giao h√†ng c·ª• th·ªÉ cho l√¥ h√†ng n√†y." }
        ]
    },
    "Coupons": {
        name: "M√£ Gi·∫£m Gi√° (Coupons)",
        description: "Qu·∫£n l√Ω c√°c m√£ gi·∫£m gi√° c·ª• th·ªÉ m√† ng∆∞·ªùi d√πng c√≥ th·ªÉ √°p d·ª•ng. Gi·ªù ƒë√¢y li√™n k·∫øt tr·ª±c ti·∫øp v·ªõi m·ªôt danh m·ª•c c·ª• th·ªÉ.",
        attributes: [
            { name: "CouponID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m√£ gi·∫£m gi√°." },
            { name: "Code", type: "UNIQUE, NOT NULL", details: "M√£ coupon (v√≠ d·ª•: 'FREESHIP2023')." },
            { name: "Description", type: "text", details: "M√¥ t·∫£ m√£ gi·∫£m gi√°." },
            { name: "DiscountType", type: "NOT NULL", details: "Lo·∫°i gi·∫£m gi√° ('percentage', 'fixed_amount', 'free_shipping')." },
            { name: "DiscountValue", type: "decimal(18,2)", details: "Gi√° tr·ªã gi·∫£m gi√° (n·∫øu c√≥, kh√¥ng √°p d·ª•ng cho freeship)." },
            { name: "StartDate", type: "NOT NULL", details: "Ng√†y b·∫Øt ƒë·∫ßu hi·ªáu l·ª±c." },
            { name: "ExpirationDate", type: "NOT NULL", details: "Ng√†y h·∫øt h·∫°n hi·ªáu l·ª±c." },
            { name: "IsFreeShipping", type: "boolean, default: false", details: "C√≥ mi·ªÖn ph√≠ v·∫≠n chuy·ªÉn hay kh√¥ng." },
            { name: "QuantityAvailable", type: "int", details: "S·ªë l∆∞·ª£ng m√£ coupon c√≤n l·∫°i (NULL n·∫øu kh√¥ng gi·ªõi h·∫°n)." },
            { name: "UsageLimitPerCustomer", type: "int", details: "S·ªë l·∫ßn s·ª≠ d·ª•ng t·ªëi ƒëa cho m·ªói kh√°ch h√†ng (NULL n·∫øu kh√¥ng gi·ªõi h·∫°n)." },
            { name: "CategoryID", type: "FK (Categories.CategoryID)", details: "Danh m·ª•c √°p d·ª•ng coupon (NULL n·∫øu √°p d·ª•ng cho t·∫•t c·∫£ s·∫£n ph·∫©m)." },
            { name: "MinOrderAmount", type: "decimal(18,2)", details: "S·ªë ti·ªÅn ƒë∆°n h√†ng t·ªëi thi·ªÉu ƒë·ªÉ √°p d·ª•ng coupon (NULL n·∫øu kh√¥ng c√≥)." },
            { name: "MaxDiscountAmount", type: "decimal(18,2)", details: "S·ªë ti·ªÅn gi·∫£m gi√° t·ªëi ƒëa (NULL n·∫øu kh√¥ng c√≥)." },
            { name: "Status", type: "default: 'active', NOT NULL", details: "Tr·∫°ng th√°i coupon ('active', 'inactive', 'expired')." },
            { name: "CreatedAt", type: "default: `getdate()`", details: "Th·ªùi gian t·∫°o b·∫£n ghi." }
        ]
    },
    "Notifications": {
        name: "Th√¥ng b√°o (Notifications)",
        description: "L∆∞u tr·ªØ c√°c th√¥ng b√°o g·ª≠i ƒë·∫øn ng∆∞·ªùi d√πng.",
        attributes: [
            { name: "NotificationID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho th√¥ng b√°o." },
            { name: "UserID", type: "FK (Users.UserID), NOT NULL", details: "Ng∆∞·ªùi d√πng nh·∫≠n th√¥ng b√°o." },
            { name: "Title", type: "NOT NULL", details: "Ti√™u ƒë·ªÅ th√¥ng b√°o." },
            { name: "Content", type: "text, NOT NULL", details: "N·ªôi dung chi ti·∫øt th√¥ng b√°o." },
            { name: "Status", type: "default: 'unread', NOT NULL", details: "Tr·∫°ng th√°i th√¥ng b√°o ('unread', 'read')." },
            { name: "CreatedAt", type: "default: `getdate()`", details: "Th·ªùi gian t·∫°o th√¥ng b√°o." }
        ]
    },
    "Admins": {
        name: "Qu·∫£n tr·ªã vi√™n (Admins)",
        description: "M·ªü r·ªông th√¥ng tin cho ng∆∞·ªùi d√πng c√≥ vai tr√≤ l√† qu·∫£n tr·ªã vi√™n.",
        attributes: [
            { name: "AdminID", type: "PK, FK (Users.UserID)", details: "M√£ ƒë·ªãnh danh qu·∫£n tr·ªã vi√™n, li√™n k·∫øt v·ªõi Users." },
            { name: "Permissions", type: "text", details: "Quy·ªÅn h·∫°n c·ª• th·ªÉ c·ªßa qu·∫£n tr·ªã vi√™n (v√≠ d·ª•: JSON ho·∫∑c text)." },
            { name: "LastActionLog", type: "text", details: "Nh·∫≠t k√Ω h√†nh ƒë·ªông cu·ªëi c√πng c·ªßa qu·∫£n tr·ªã vi√™n." }
        ]
    }
};

const relationshipsData = [
    { name: "Users - Roles", type: "N:1", from: "Users", to: "Roles", details: "M·ªôt ng∆∞·ªùi d√πng thu·ªôc v·ªÅ m·ªôt vai tr√≤ duy nh·∫•t. `Users.RoleID` (FK) -> `Roles.RoleID` (PK)." },
    { name: "Users - Sellers", type: "1:1 (ho·∫∑c 1:0..1)", from: "Users", to: "Sellers", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ l√† m·ªôt ng∆∞·ªùi b√°n. `Sellers.SellerID` (PK, FK) -> `Users.UserID` (PK)." },
    { name: "Users - Admins", type: "1:1 (ho·∫∑c 1:0..1)", from: "Users", to: "Admins", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ l√† m·ªôt qu·∫£n tr·ªã vi√™n. `Admins.AdminID` (PK, FK) -> `Users.UserID` (PK)." },
    { name: "Users - Addresses", type: "1:N", from: "Users", to: "Addresses", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ c√≥ nhi·ªÅu ƒë·ªãa ch·ªâ. `Addresses.UserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - ShoppingCarts", type: "1:N", from: "Users", to: "ShoppingCarts", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ c√≥ nhi·ªÅu gi·ªè h√†ng (n·∫øu h·ªá th·ªëng h·ªó tr·ª£ nhi·ªÅu gi·ªè h√†ng ho·∫∑c l·ªãch s·ª≠ gi·ªè h√†ng). `ShoppingCarts.UserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - Wishlists", type: "1:N", from: "Users", to: "Wishlists", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ c√≥ nhi·ªÅu m·ª•c trong danh s√°ch y√™u th√≠ch. `Wishlists.UserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - Orders", type: "1:N", from: "Users", to: "Orders", details: "M·ªôt ng∆∞·ªùi d√πng (ng∆∞·ªùi mua) c√≥ th·ªÉ ƒë·∫∑t nhi·ªÅu ƒë∆°n h√†ng. `Orders.UserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - Payments", type: "1:N", from: "Users", to: "Payments", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ th·ª±c hi·ªán nhi·ªÅu giao d·ªãch thanh to√°n. `Payments.UserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - ProductReviews", type: "1:N", from: "Users", to: "ProductReviews", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ vi·∫øt nhi·ªÅu ƒë√°nh gi√° s·∫£n ph·∫©m. `ProductReviews.UserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - ProductTransformations", type: "1:N", from: "Users", to: "ProductTransformations", details: "M·ªôt ng∆∞·ªùi d√πng (admin/seller) c√≥ th·ªÉ th·ª±c hi·ªán nhi·ªÅu giao d·ªãch chuy·ªÉn ƒë·ªïi s·∫£n ph·∫©m. `ProductTransformations.TransformedByUserID` (FK) -> `Users.UserID` (PK)." },
    { name: "Users - Notifications", type: "1:N", from: "Users", to: "Notifications", details: "M·ªôt ng∆∞·ªùi d√πng c√≥ th·ªÉ nh·∫≠n nhi·ªÅu th√¥ng b√°o. `Notifications.UserID` (FK) -> `Users.UserID` (PK)." },

    { name: "Cities - Districts", type: "1:N", from: "Cities", to: "Districts", details: "M·ªôt th√†nh ph·ªë c√≥ nhi·ªÅu qu·∫≠n/huy·ªán. `Districts.CityID` (FK) -> `Cities.CityID` (PK)." },
    { name: "Cities - Addresses", type: "1:N", from: "Cities", to: "Addresses", details: "M·ªôt th√†nh ph·ªë c√≥ th·ªÉ c√≥ nhi·ªÅu ƒë·ªãa ch·ªâ. `Addresses.CityID` (FK) -> `Cities.CityID` (PK)." },
    { name: "Districts - Addresses", type: "1:N", from: "Districts", to: "Addresses", details: "M·ªôt qu·∫≠n/huy·ªán c√≥ th·ªÉ c√≥ nhi·ªÅu ƒë·ªãa ch·ªâ. `Addresses.DistrictID` (FK) -> `Districts.DistrictID` (PK)." },

    { name: "Categories - Products", type: "1:N", from: "Categories", to: "Products", details: "M·ªôt danh m·ª•c c√≥ th·ªÉ ch·ª©a nhi·ªÅu s·∫£n ph·∫©m. `Products.CategoryID` (FK) -> `Categories.CategoryID` (PK)." },
    { name: "Categories - Categories (Self-referencing)", type: "1:N", from: "Categories", to: "Categories", details: "M·ªôt danh m·ª•c cha c√≥ th·ªÉ c√≥ nhi·ªÅu danh m·ª•c con. `Categories.ParentCategoryID` (FK) -> `Categories.CategoryID` (PK)." },
    { name: "Categories - Sales", type: "N:1", from: "Sales", to: "Categories", details: "M·ªôt ch∆∞∆°ng tr√¨nh gi·∫£m gi√° c√≥ th·ªÉ √°p d·ª•ng cho m·ªôt danh m·ª•c c·ª• th·ªÉ (ho·∫∑c NULL cho t·∫•t c·∫£). `Sales.CategoryID` (FK) -> `Categories.CategoryID` (PK)." },
    { name: "Categories - Coupons", type: "N:1", from: "Coupons", to: "Categories", details: "M·ªôt m√£ gi·∫£m gi√° c√≥ th·ªÉ √°p d·ª•ng cho m·ªôt danh m·ª•c c·ª• th·ªÉ (ho·∫∑c NULL cho t·∫•t c·∫£). `Coupons.CategoryID` (FK) -> `Categories.CategoryID` (PK)." },


    { name: "Sellers - Products", type: "1:N", from: "Sellers", to: "Products", details: "M·ªôt ng∆∞·ªùi b√°n c√≥ th·ªÉ b√°n nhi·ªÅu s·∫£n ph·∫©m. `Products.SellerID` (FK) -> `Sellers.SellerID` (PK)." },
    { name: "Sellers - OrderItems", type: "1:N", from: "Sellers", to: "OrderItems", details: "M·ªôt ng∆∞·ªùi b√°n c√≥ th·ªÉ c√≥ s·∫£n ph·∫©m trong nhi·ªÅu m·ª•c ƒë∆°n h√†ng. `OrderItems.SellerID` (FK) -> `Sellers.SellerID` (PK)." },

    { name: "Products - ProductImages", type: "1:N", from: "Products", to: "ProductImages", details: "M·ªôt s·∫£n ph·∫©m c√≥ th·ªÉ c√≥ nhi·ªÅu h√¨nh ·∫£nh. `ProductImages.ProductID` (FK) -> `Products.ProductID` (PK)." },
    { name: "Products - CartItems", type: "1:N", from: "Products", to: "CartItems", details: "M·ªôt s·∫£n ph·∫©m c√≥ th·ªÉ xu·∫•t hi·ªán trong nhi·ªÅu m·ª•c gi·ªè h√†ng. `CartItems.ProductID` (FK) -> `Products.ProductID` (PK)." },
    { name: "Products - Wishlists", type: "1:N", from: "Products", to: "Wishlists", details: "M·ªôt s·∫£n ph·∫©m c√≥ th·ªÉ xu·∫•t hi·ªán trong nhi·ªÅu danh s√°ch y√™u th√≠ch. `Wishlists.ProductID` (FK) -> `Products.ProductID` (PK)." },
    { name: "Products - OrderItems", type: "M:N (qua OrderItems)", from: "Products", to: "OrderItems", details: "M·ªôt s·∫£n ph·∫©m c√≥ th·ªÉ xu·∫•t hi·ªán trong nhi·ªÅu chi ti·∫øt ƒë∆°n h√†ng. `OrderItems.ProductID` (FK) -> `Products.ProductID` (PK)." },
    { name: "Products - ProductReviews", type: "1:N", from: "Products", to: "ProductReviews", details: "M·ªôt s·∫£n ph·∫©m c√≥ th·ªÉ nh·∫≠n nhi·ªÅu ƒë√°nh gi√°. `ProductReviews.ProductID` (FK) -> `Products.ProductID` (PK)." },
    { name: "Products - ProductTransformations (Source)", type: "1:N", from: "Products", to: "ProductTransformations", details: "M·ªôt s·∫£n ph·∫©m g·ªëc c√≥ th·ªÉ l√† ngu·ªìn cho nhi·ªÅu giao d·ªãch chuy·ªÉn ƒë·ªïi. `ProductTransformations.SourceProductID` (FK) -> `Products.ProductID` (PK)." },
    { name: "Products - ProductTransformations (Derived)", type: "1:N", from: "Products", to: "ProductTransformations", details: "M·ªôt s·∫£n ph·∫©m (ƒë∆∞·ª£c t√°i ch·∫ø/chuy·ªÉn ƒë·ªïi) c√≥ th·ªÉ l√† k·∫øt qu·∫£ c·ªßa nhi·ªÅu giao d·ªãch chuy·ªÉn ƒë·ªïi. `ProductTransformations.DerivedProductID` (FK) -> `Products.ProductID` (PK)." },

    { name: "ShoppingCarts - CartItems", type: "1:N", from: "ShoppingCarts", to: "CartItems", details: "M·ªôt gi·ªè h√†ng c√≥ th·ªÉ ch·ª©a nhi·ªÅu m·ª•c. `CartItems.CartID` (FK) -> `ShoppingCarts.CartID` (PK)." },

    { name: "Orders - OrderItems", type: "1:N", from: "Orders", to: "OrderItems", details: "M·ªôt ƒë∆°n h√†ng c√≥ th·ªÉ bao g·ªìm nhi·ªÅu m·∫∑t h√†ng. `OrderItems.OrderID` (FK) -> `Orders.OrderID` (PK)." },
    { name: "Orders - Payments", type: "1:1", from: "Orders", to: "Payments", details: "M·ªói ƒë∆°n h√†ng th∆∞·ªùng li√™n k·∫øt v·ªõi m·ªôt giao d·ªãch thanh to√°n duy nh·∫•t. `Payments.OrderID` (FK, UNIQUE) -> `Orders.OrderID` (PK)." },
    { name: "Orders - DeliveryPartners", type: "N:1", from: "Orders", to: "DeliveryPartners", details: "M·ªôt ƒë∆°n h√†ng ƒë∆∞·ª£c giao b·ªüi m·ªôt ƒë·ªëi t√°c v·∫≠n chuy·ªÉn. `Orders.DeliveryPartnerID` (FK) -> `DeliveryPartners.PartnerID` (PK)." },
    { name: "Orders - Addresses (Shipping)", type: "N:1", from: "Orders", to: "Addresses", details: "M·ªôt ƒë∆°n h√†ng c√≥ m·ªôt ƒë·ªãa ch·ªâ giao h√†ng. `Orders.ShippingAddressID` (FK) -> `Addresses.AddressID` (PK)." },
    { name: "Orders - Addresses (Billing)", type: "N:1", from: "Orders", to: "Addresses", details: "M·ªôt ƒë∆°n h√†ng c√≥ m·ªôt ƒë·ªãa ch·ªâ thanh to√°n. `Orders.BillingAddressID` (FK) -> `Addresses.AddressID` (PK)." },
    { name: "Orders - PaymentMethods", type: "N:1", from: "Orders", to: "PaymentMethods", details: "M·ªôt ƒë∆°n h√†ng s·ª≠ d·ª•ng m·ªôt ph∆∞∆°ng th·ª©c thanh to√°n. `Orders.PaymentMethodID` (FK) -> `PaymentMethods.MethodID` (PK)." },

    { name: "PaymentMethods - Payments", type: "1:N", from: "PaymentMethods", to: "Payments", details: "M·ªôt ph∆∞∆°ng th·ª©c thanh to√°n c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng cho nhi·ªÅu giao d·ªãch. `Payments.MethodID` (FK) -> `PaymentMethods.MethodID` (PK)." },

    { name: "OrderItems - ProductReviews", type: "1:1", from: "OrderItems", to: "ProductReviews", details: "M·ªói m·ª•c ƒë∆°n h√†ng ch·ªâ c√≥ th·ªÉ c√≥ m·ªôt ƒë√°nh gi√°. `ProductReviews.OrderItemID` (FK, UNIQUE) -> `OrderItems.OrderItemID` (PK)." },

    // New relationships for Shipments
    { name: "Orders - Shipments", type: "1:N", from: "Orders", to: "Shipments", details: "M·ªôt ƒë∆°n h√†ng c√≥ th·ªÉ c√≥ nhi·ªÅu l√¥ h√†ng (n·∫øu c√°c s·∫£n ph·∫©m ƒë∆∞·ª£c giao ri√™ng l·∫ª ho·∫∑c t·ª´ nhi·ªÅu kho). `Shipments.OrderID` (FK) -> `Orders.OrderID` (PK)." },
    { name: "DeliveryPartners - Shipments", type: "1:N", from: "DeliveryPartners", to: "Shipments", details: "M·ªôt ƒë·ªëi t√°c v·∫≠n chuy·ªÉn c√≥ th·ªÉ x·ª≠ l√Ω nhi·ªÅu l√¥ h√†ng. `Shipments.DeliveryPartnerID` (FK) -> `DeliveryPartners.PartnerID` (PK)." },
    { name: "Addresses - Shipments", type: "N:1", from: "Addresses", to: "Shipments", details: "M·ªôt l√¥ h√†ng c√≥ m·ªôt ƒë·ªãa ch·ªâ giao h√†ng c·ª• th·ªÉ. `Shipments.ShippingAddressID` (FK) -> `Addresses.AddressID` (PK)." }
];

const constraintsData = [
    {
        name: "PRIMARY KEY (Kh√≥a Ch√≠nh)",
        description: "M·ªôt c·ªôt ho·∫∑c m·ªôt t·∫≠p h·ª£p c√°c c·ªôt x√°c ƒë·ªãnh duy nh·∫•t m·ªói h√†ng trong m·ªôt b·∫£ng. Kh√≥a ch√≠nh kh√¥ng ƒë∆∞·ª£c ch·ª©a gi√° tr·ªã NULL v√† ph·∫£i l√† duy nh·∫•t.",
        howItWorks: "Khi m·ªôt c·ªôt ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† kh√≥a ch√≠nh, DBMS t·ª± ƒë·ªông t·∫°o m·ªôt ch·ªâ m·ª•c duy nh·∫•t tr√™n c·ªôt ƒë√≥ ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô truy v·∫•n v√† ƒë·∫£m b·∫£o t√≠nh duy nh·∫•t. M·ªói b·∫£ng ch·ªâ c√≥ th·ªÉ c√≥ m·ªôt kh√≥a ch√≠nh.",
        examples: [
            "`Users.UserID` PK: M·ªói ng∆∞·ªùi d√πng c√≥ m·ªôt m√£ ƒë·ªãnh danh duy nh·∫•t.",
            "`Products.ProductID` PK: M·ªói s·∫£n ph·∫©m c√≥ m·ªôt m√£ ƒë·ªãnh danh duy nh·∫•t.",
            "`Orders.OrderID` PK: M·ªói ƒë∆°n h√†ng c√≥ m·ªôt m√£ ƒë·ªãnh danh duy nh·∫•t."
        ]
    },
    {
        name: "FOREIGN KEY (Kh√≥a Ngo·∫°i)",
        description: "M·ªôt c·ªôt ho·∫∑c t·∫≠p h·ª£p c√°c c·ªôt trong m·ªôt b·∫£ng (b·∫£ng con) tham chi·∫øu ƒë·∫øn kh√≥a ch√≠nh c·ªßa m·ªôt b·∫£ng kh√°c (b·∫£ng cha). Kh√≥a ngo·∫°i thi·∫øt l·∫≠p m·ªëi li√™n k·∫øt gi·ªØa hai b·∫£ng v√† ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn tham chi·∫øu.",
        howItWorks: "ƒê·∫£m b·∫£o r·∫±ng m·ªçi gi√° tr·ªã ƒë∆∞·ª£c ch√®n ho·∫∑c c·∫≠p nh·∫≠t v√†o c·ªôt kh√≥a ngo·∫°i ph·∫£i t·ªìn t·∫°i trong c·ªôt kh√≥a ch√≠nh c·ªßa b·∫£ng cha. Khi x√≥a/c·∫≠p nh·∫≠t b·∫£ng cha, DBMS s·∫Ω ki·ªÉm tra c√°c h√†ng li√™n quan trong b·∫£ng con v√† √°p d·ª•ng quy t·∫Øc h√†nh ƒë·ªông (v√≠ d·ª•: RESTRICT, CASCADE, SET NULL, SET DEFAULT).",
        examples: [
            "`Orders.UserID` FK REFERENCES `Users(UserID)`: M·ªói ƒë∆°n h√†ng ph·∫£i thu·ªôc v·ªÅ m·ªôt ng∆∞·ªùi d√πng ƒë√£ t·ªìn t·∫°i.",
            "`Products.CategoryID` FK REFERENCES `Categories(CategoryID)`: M·ªói s·∫£n ph·∫©m ph·∫£i thu·ªôc v·ªÅ m·ªôt danh m·ª•c ƒë√£ t·ªìn t·∫°i.",
            "`OrderItems.ProductID` FK REFERENCES `Products(ProductID)`: M·ªói m·ª•c trong ƒë∆°n h√†ng ph·∫£i l√† m·ªôt s·∫£n ph·∫©m ƒë√£ t·ªìn t·∫°i."
        ]
    },
    {
        name: "NOT NULL",
        description: "R√†ng bu·ªôc n√†y ƒë·∫£m b·∫£o r·∫±ng m·ªôt c·ªôt kh√¥ng th·ªÉ ch·ª©a gi√° tr·ªã NULL (r·ªóng). ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† m·ªói h√†ng ph·∫£i c√≥ m·ªôt gi√° tr·ªã c·ª• th·ªÉ cho c·ªôt ƒë√≥.",
        howItWorks: "N·∫øu b·∫°n c·ªë g·∫Øng ch√®n m·ªôt h√†ng m·ªõi ho·∫∑c c·∫≠p nh·∫≠t m·ªôt h√†ng hi·ªán c√≥ m√† ƒë·ªÉ tr·ªëng (NULL) m·ªôt c·ªôt c√≥ r√†ng bu·ªôc NOT NULL, thao t√°c s·∫Ω b·ªã t·ª´ ch·ªëi.",
        examples: [
            "`Users.PhoneNumber` NOT NULL: M·ªói ng∆∞·ªùi d√πng ph·∫£i c√≥ s·ªë ƒëi·ªán tho·∫°i.",
            "`Products.Name` NOT NULL: M·ªói s·∫£n ph·∫©m ph·∫£i c√≥ t√™n.",
            "`Orders.OrderDate` NOT NULL: M·ªói ƒë∆°n h√†ng ph·∫£i c√≥ ng√†y ƒë·∫∑t h√†ng."
        ]
    },
    {
        name: "UNIQUE",
        description: "R√†ng bu·ªôc n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ c√°c gi√° tr·ªã trong m·ªôt c·ªôt (ho·∫∑c t·∫≠p h·ª£p c√°c c·ªôt) ph·∫£i l√† duy nh·∫•t. M·ªôt b·∫£ng c√≥ th·ªÉ c√≥ nhi·ªÅu r√†ng bu·ªôc UNIQUE v√† c·ªôt UNIQUE c√≥ th·ªÉ ch·ª©a gi√° tr·ªã NULL (th∆∞·ªùng ch·ªâ m·ªôt gi√° tr·ªã NULL duy nh·∫•t ƒë∆∞·ª£c ph√©p, t√πy DBMS).",
        howItWorks: "N·∫øu b·∫°n c·ªë g·∫Øng ch√®n m·ªôt gi√° tr·ªã ƒë√£ t·ªìn t·∫°i v√†o m·ªôt c·ªôt c√≥ r√†ng bu·ªôc UNIQUE, thao t√°c s·∫Ω b·ªã t·ª´ ch·ªëi. Kh√°c v·ªõi PRIMARY KEY, UNIQUE kh√¥ng nh·∫•t thi·∫øt ph·∫£i l√† kh√≥a ch√≠nh v√† c√≥ th·ªÉ cho ph√©p NULL.",
        examples: [
            "`Users.Username` UNIQUE: T√™n ƒëƒÉng nh·∫≠p c·ªßa m·ªói ng∆∞·ªùi d√πng ph·∫£i l√† duy nh·∫•t.",
            "`Categories.Name` UNIQUE: T√™n m·ªói danh m·ª•c s·∫£n ph·∫©m ph·∫£i l√† duy nh·∫•t.",
            "`Coupons.Code` UNIQUE: M√£ coupon ph·∫£i l√† duy nh·∫•t."
        ]
    },
    {
        name: "CHECK",
        description: "R√†ng bu·ªôc CHECK ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ƒë·ªãnh nghƒ©a m·ªôt ƒëi·ªÅu ki·ªán logic m√† d·ªØ li·ªáu trong m·ªôt c·ªôt (ho·∫∑c nhi·ªÅu c·ªôt) ph·∫£i th·ªèa m√£n. ƒêi·ªÅu ki·ªán n√†y ƒë∆∞·ª£c ƒë√°nh gi√° m·ªói khi d·ªØ li·ªáu ƒë∆∞·ª£c ch√®n ho·∫∑c c·∫≠p nh·∫≠t.",
        howItWorks: "M·ªói khi m·ªôt h√†ng ƒë∆∞·ª£c ch√®n ho·∫∑c c·∫≠p nh·∫≠t, ƒëi·ªÅu ki·ªán trong CHECK s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông ki·ªÉm tra. N·∫øu ƒëi·ªÅu ki·ªán tr·∫£ v·ªÅ FALSE, thao t√°c s·∫Ω b·ªã t·ª´ ch·ªëi.",
        examples: [
            "`Products.Price` CHECK (`Price` > 0): ƒê·∫£m b·∫£o gi√° s·∫£n ph·∫©m lu√¥n l√† m·ªôt s·ªë d∆∞∆°ng.",
            "`OrderItems.Quantity` CHECK (`Quantity` > 0): ƒê·∫£m b·∫£o s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong ƒë∆°n h√†ng lu√¥n l·ªõn h∆°n 0.",
            "`Users.Status` CHECK (`Status` IN ('active', 'inactive', 'suspended')): ƒê·∫£m b·∫£o tr·∫°ng th√°i ng∆∞·ªùi d√πng ch·ªâ thu·ªôc m·ªôt trong c√°c gi√° tr·ªã h·ª£p l·ªá."
        ]
    },
    {
        name: "DEFAULT",
        description: "R√†ng bu·ªôc DEFAULT ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ cung c·∫•p m·ªôt gi√° tr·ªã m·∫∑c ƒë·ªãnh cho m·ªôt c·ªôt n·∫øu kh√¥ng c√≥ gi√° tr·ªã n√†o ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh khi ch√®n m·ªôt h√†ng m·ªõi.",
        howItWorks: "N·∫øu m·ªôt c·ªôt c√≥ r√†ng bu·ªôc DEFAULT b·ªã b·ªè qua trong c√¢u l·ªánh INSERT, c∆° s·ªü d·ªØ li·ªáu s·∫Ω t·ª± ƒë·ªông s·ª≠ d·ª•ng gi√° tr·ªã m·∫∑c ƒë·ªãnh ƒë√£ ƒë·ªãnh nghƒ©a cho c·ªôt ƒë√≥.",
        examples: [
            "`Orders.Status` DEFAULT 'pending': N·∫øu kh√¥ng ch·ªâ ƒë·ªãnh, tr·∫°ng th√°i ƒë∆°n h√†ng m·∫∑c ƒë·ªãnh l√† 'pending'.",
            "`Users.RegistrationDate` DEFAULT GETDATE(): Ng√†y ƒëƒÉng k√Ω m·∫∑c ƒë·ªãnh l√† th·ªùi ƒëi·ªÉm hi·ªán t·∫°i.",
            "`Products.StockQuantity` DEFAULT 0: S·ªë l∆∞·ª£ng t·ªìn kho m·∫∑c ƒë·ªãnh l√† 0 n·∫øu kh√¥ng ƒë∆∞·ª£c cung c·∫•p."
        ]
    }
];

const expirationRepurposingData = {
    problem: {
        title: "B√†i to√°n: Qu·∫£n l√Ω H·∫°n s·ª≠ d·ª•ng v√† T√°i ch·∫ø S·∫£n ph·∫©m",
        description: "Trong m·ªôt s·ªë ng√†nh h√†ng nh∆∞ th·ª±c ph·∫©m, d∆∞·ª£c ph·∫©m, vi·ªác qu·∫£n l√Ω h·∫°n s·ª≠ d·ª•ng (HSD) c·ªßa s·∫£n ph·∫©m l√† r·∫•t quan tr·ªçng. ƒê·ªìng th·ªùi, kh·∫£ nƒÉng t√°i ch·∫ø ho·∫∑c chuy·ªÉn ƒë·ªïi s·∫£n ph·∫©m g·∫ßn h·∫øt h·∫°n th√†nh m·ªôt d·∫°ng s·∫£n ph·∫©m kh√°c (v√≠ d·ª•: c√† r·ªët t∆∞∆°i th√†nh n∆∞·ªõc √©p c√† r·ªët) c√≥ th·ªÉ gi√∫p gi·∫£m thi·ªÉu l√£ng ph√≠ v√† t·ªëi ∆∞u h√≥a gi√° tr·ªã. Ph·∫ßn n√†y s·∫Ω th·∫£o lu·∫≠n v·ªÅ c√°ch m·ªü r·ªông m√¥ h√¨nh c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ gi·∫£i quy·∫øt c√°c y√™u c·∫ßu n√†y d·ª±a tr√™n l∆∞·ª£c ƒë·ªì b·∫°n ƒë√£ cung c·∫•p."
    },
    expirationSolution: {
        title: "Gi·∫£i ph√°p cho H·∫°n s·ª≠ d·ª•ng: B·∫£ng `Products`",
        description: "Theo l∆∞·ª£c ƒë·ªì b·∫°n cung c·∫•p, th√¥ng tin h·∫°n s·ª≠ d·ª•ng (`ImportDate` v√† `ExpirationDate`) ƒë∆∞·ª£c l∆∞u tr·ªØ tr·ª±c ti·∫øp trong b·∫£ng `Products`.",
        table: {
            name: "Products (S·∫£n ph·∫©m)",
            attributes: [
                { name: "ProductID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho s·∫£n ph·∫©m." },
                { name: "ImportDate", type: "date", details: "Ng√†y nh·∫≠p s·∫£n ph·∫©m v√†o kho." },
                { name: "ExpirationDate", type: "date", details: "Ng√†y h·∫øt h·∫°n c·ªßa s·∫£n ph·∫©m." },
                { name: "IsRecyclable", type: "boolean, default: false", details: "C·ªù ch·ªâ ƒë·ªãnh s·∫£n ph·∫©m c√≥ th·ªÉ t√°i ch·∫ø/chuy·ªÉn ƒë·ªïi th√†nh s·∫£n ph·∫©m kh√°c hay kh√¥ng." }
            ]
        },
        explanation: "Trong m√¥ h√¨nh n√†y, `ExpirationDate` ƒë∆∞·ª£c g√°n cho t·ª´ng `ProductID`, t·ª©c l√† cho t·ª´ng lo·∫°i s·∫£n ph·∫©m. ƒêi·ªÅu n√†y ph√π h·ª£p n·∫øu t·∫•t c·∫£ c√°c ƒë∆°n v·ªã c·ªßa m·ªôt lo·∫°i s·∫£n ph·∫©m c·ª• th·ªÉ ƒë·ªÅu c√≥ c√πng m·ªôt h·∫°n s·ª≠ d·ª•ng. Thu·ªôc t√≠nh `IsRecyclable` c≈©ng ƒë∆∞·ª£c th√™m v√†o b·∫£ng `Products` ƒë·ªÉ d·ªÖ d√†ng x√°c ƒë·ªãnh nh·ªØng s·∫£n ph·∫©m c√≥ ti·ªÅm nƒÉng t√°i ch·∫ø. V·ªõi l∆∞·ª£c ƒë·ªì hi·ªán t·∫°i, th√¥ng tin h·∫°n s·ª≠ d·ª•ng ƒë∆∞·ª£c qu·∫£n l√Ω tr·ª±c ti·∫øp tr√™n s·∫£n ph·∫©m, kh√¥ng c·∫ßn b·∫£ng `Inventory_Lot` ri√™ng bi·ªát cho m·ª•c ƒë√≠ch n√†y."
    },
    repurposingSolution: {
        title: "Gi·∫£i ph√°p cho T√°i ch·∫ø/Chuy·ªÉn ƒë·ªïi s·∫£n ph·∫©m: B·∫£ng `ProductTransformations`",
        description: "B·∫£ng n√†y ghi l·∫°i qu√° tr√¨nh chuy·ªÉn ƒë·ªïi m·ªôt s·∫£n ph·∫©m g·ªëc (c√≥ th·ªÉ g·∫ßn h·∫øt h·∫°n) th√†nh m·ªôt s·∫£n ph·∫©m m·ªõi (t√°i ch·∫ø).",
        table: {
            name: "ProductTransformations (Chuy·ªÉn ƒê·ªïi S·∫£n Ph·∫©m)",
            attributes: [
                { name: "TransformationID", type: "PK, increment", details: "M√£ ƒë·ªãnh danh duy nh·∫•t cho m·ªói giao d·ªãch chuy·ªÉn ƒë·ªïi." },
                { name: "SourceProductID", type: "FK (Products.ProductID), NOT NULL", details: "S·∫£n ph·∫©m g·ªëc ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi (v√≠ d·ª•: c√† r·ªët t∆∞∆°i)." },
                { name: "SourceImportDate", type: "date", details: "Ng√†y nh·∫≠p c·ªßa s·∫£n ph·∫©m g·ªëc (ƒë·ªÉ tham chi·∫øu l√¥ c·ª• th·ªÉ n·∫øu c·∫ßn)." },
                { name: "SourceExpirationDate", type: "date", details: "Ng√†y h·∫øt h·∫°n c·ªßa s·∫£n ph·∫©m g·ªëc (ƒë·ªÉ tham chi·∫øu l√¥ c·ª• th·ªÉ n·∫øu c·∫ßn)." },
                { name: "QuantityTransformed", type: "NOT NULL", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m g·ªëc ƒë√£ s·ª≠ d·ª•ng trong qu√° tr√¨nh chuy·ªÉn ƒë·ªïi." },
                { name: "DerivedProductID", type: "FK (Products.ProductID), NOT NULL", details: "S·∫£n ph·∫©m m·ªõi ƒë∆∞·ª£c t·∫°o ra sau chuy·ªÉn ƒë·ªïi (c≈©ng l√† m·ªôt Product trong b·∫£ng Products)." },
                { name: "DerivedQuantityProduced", type: "NOT NULL", details: "S·ªë l∆∞·ª£ng s·∫£n ph·∫©m m·ªõi ƒë∆∞·ª£c t·∫°o ra." },
                { name: "TransformationDate", type: "default: `getdate()`", details: "Ng√†y v√† gi·ªù th·ª±c hi·ªán chuy·ªÉn ƒë·ªïi." },
                { name: "TransformedByUserID", type: "FK (Users.UserID)", details: "Ng∆∞·ªùi d√πng (admin/seller) th·ª±c hi·ªán chuy·ªÉn ƒë·ªïi." },
                { name: "Notes", type: "text", details: "Ghi ch√∫ th√™m v·ªÅ qu√° tr√¨nh chuy·ªÉn ƒë·ªïi." }
            ]
        },
        explanation: "Khi m·ªôt s·∫£n ph·∫©m (v√≠ d·ª•: c√† r·ªët) ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi th√†nh s·∫£n ph·∫©m kh√°c (n∆∞·ªõc √©p), h·ªá th·ªëng s·∫Ω ghi nh·∫≠n giao d·ªãch n√†y v√†o b·∫£ng `ProductTransformations`. `SourceProductID` v√† `DerivedProductID` ƒë·ªÅu tham chi·∫øu ƒë·∫øn c√°c b·∫£n ghi trong b·∫£ng `Products`. ƒêi·ªÅu n√†y cho ph√©p m·ªôt s·∫£n ph·∫©m g·ªëc c√≥ th·ªÉ t·∫°o ra nhi·ªÅu lo·∫°i s·∫£n ph·∫©m t√°i ch·∫ø kh√°c nhau (v√≠ d·ª•: c√† r·ªët c√≥ th·ªÉ th√†nh n∆∞·ªõc √©p ho·∫∑c th√†nh nguy√™n li·ªáu s√∫p). Sau khi chuy·ªÉn ƒë·ªïi, s·ªë l∆∞·ª£ng t·ªìn kho c·ªßa `SourceProductID` s·∫Ω gi·∫£m v√† c·ªßa `DerivedProductID` s·∫Ω tƒÉng. Vi·ªác l∆∞u tr·ªØ `SourceImportDate` v√† `SourceExpirationDate` tr·ª±c ti·∫øp trong b·∫£ng n√†y gi√∫p truy v·∫øt ngu·ªìn g·ªëc c·ªßa s·∫£n ph·∫©m ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi."
    },
    needForNewTables: {
        title: "S·ª± c·∫ßn thi·∫øt c·ªßa b·∫£ng `ProductTransformations`",
        explanation: "B·∫£ng `ProductTransformations` l√† c·∫ßn thi·∫øt ƒë·ªÉ ghi l·∫°i <strong>s·ª± ki·ªán</strong> chuy·ªÉn ƒë·ªïi s·∫£n ph·∫©m. N·∫øu kh√¥ng c√≥ b·∫£ng n√†y, vi·ªác theo d√µi l·ªãch s·ª≠ t√°i ch·∫ø, s·ªë l∆∞·ª£ng s·∫£n ph·∫©m g·ªëc ƒë√£ d√πng, v√† s·ªë l∆∞·ª£ng s·∫£n ph·∫©m m·ªõi t·∫°o ra s·∫Ω r·∫•t kh√≥ khƒÉn ho·∫∑c kh√¥ng th·ªÉ. N√≥ gi√∫p duy tr√¨ t√≠nh to√†n v·∫πn d·ªØ li·ªáu v√† cung c·∫•p kh·∫£ nƒÉng truy xu·∫•t ngu·ªìn g·ªëc cho c√°c s·∫£n ph·∫©m ƒë∆∞·ª£c t√°i ch·∫ø, ƒë·ªìng th·ªùi h·ªó tr·ª£ c√°c b√°o c√°o v·ªÅ hi·ªáu qu·∫£ qu·∫£n l√Ω t·ªìn kho v√† gi·∫£m l√£ng ph√≠. Trong khi ƒë√≥, v·ªõi l∆∞·ª£c ƒë·ªì DBML hi·ªán t·∫°i, b·∫£ng `Inventory_Lot` kh√¥ng c√≤n c·∫ßn thi·∫øt cho vi·ªác qu·∫£n l√Ω HSD v√¨ c√°c thu·ªôc t√≠nh ƒë√≥ ƒë√£ ƒë∆∞·ª£c chuy·ªÉn tr·ª±c ti·∫øp v√†o b·∫£ng `Products`."
    }
};

const sqlSchemaData = `
-- Table Roles
CREATE TABLE Roles (
    RoleID INT IDENTITY(1,1) PRIMARY KEY,
    RoleName VARCHAR(50) UNIQUE NOT NULL
);

-- Table Users
CREATE TABLE Users (
    UserID INT IDENTITY(1,1) PRIMARY KEY,
    Username VARCHAR(50) UNIQUE NOT NULL,
    PasswordHash VARCHAR(255) NOT NULL,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100) UNIQUE,
    PhoneNumber VARCHAR(20) UNIQUE NOT NULL,
    DateOfBirth DATE,
    ProfilePictureUrl VARCHAR(255),
    RoleID INT NOT NULL,
    RegistrationDate DATETIME DEFAULT GETDATE(),
    LastLoginDate DATETIME,
    Status VARCHAR(20) DEFAULT 'active' NOT NULL,
    CONSTRAINT CK_Users_Status CHECK (Status IN ('active', 'inactive', 'suspended')),
    CONSTRAINT FK_Users_Roles FOREIGN KEY (RoleID) REFERENCES Roles(RoleID)
);

-- Table Sellers
CREATE TABLE Sellers (
    SellerID INT PRIMARY KEY,
    StoreName VARCHAR(255) NOT NULL,
    StoreDescription TEXT,
    BankAccountDetails VARCHAR(255),
    BusinessLicenseNumber VARCHAR(50) UNIQUE,
    SellerRating DECIMAL(2,1) DEFAULT 0,
    JoinDate DATETIME DEFAULT GETDATE(),
    IsVerified BIT DEFAULT 0,
    CONSTRAINT CK_Sellers_Rating CHECK (SellerRating >= 0 AND SellerRating <= 5),
    CONSTRAINT FK_Sellers_Users FOREIGN KEY (SellerID) REFERENCES Users(UserID)
);

-- Table Cities
CREATE TABLE Cities (
    CityID INT IDENTITY(1,1) PRIMARY KEY,
    CityName VARCHAR(100) UNIQUE NOT NULL
);

-- Table Districts
CREATE TABLE Districts (
    DistrictID INT IDENTITY(1,1) PRIMARY KEY,
    CityID INT NOT NULL,
    DistrictName VARCHAR(100) NOT NULL,
    CONSTRAINT UQ_Districts_CityID_DistrictName UNIQUE (CityID, DistrictName),
    CONSTRAINT FK_Districts_Cities FOREIGN KEY (CityID) REFERENCES Cities(CityID)
);

-- Table Addresses
CREATE TABLE Addresses (
    AddressID INT IDENTITY(1,1) PRIMARY KEY,
    UserID INT NOT NULL,
    StreetAddress VARCHAR(255) NOT NULL,
    CityID INT NOT NULL,
    DistrictID INT NOT NULL,
    AddressType VARCHAR(20) DEFAULT 'shipping' NOT NULL,
    IsDefault BIT DEFAULT 0,
    CONSTRAINT CK_Addresses_Type CHECK (AddressType IN ('shipping', 'billing', 'home', 'work')),
    CONSTRAINT FK_Addresses_Users FOREIGN KEY (UserID) REFERENCES Users(UserID),
    CONSTRAINT FK_Addresses_Cities FOREIGN KEY (CityID) REFERENCES Cities(CityID),
    CONSTRAINT FK_Addresses_Districts FOREIGN KEY (DistrictID) REFERENCES Districts(DistrictID)
);

-- Table Categories
CREATE TABLE Categories (
    CategoryID INT IDENTITY(1,1) PRIMARY KEY,
    Name VARCHAR(100) UNIQUE NOT NULL,
    Description TEXT,
    ParentCategoryID INT,
    CONSTRAINT FK_Categories_ParentCategory FOREIGN KEY (ParentCategoryID) REFERENCES Categories(CategoryID)
);

-- Table Products
CREATE TABLE Products (
    ProductID INT IDENTITY(1,1) PRIMARY KEY,
    SellerID INT NOT NULL,
    CategoryID INT NOT NULL,
    Name VARCHAR(255) NOT NULL,
    Description TEXT,
    Price DECIMAL(18,2) NOT NULL,
    StockQuantity INT DEFAULT 0,
    Unit VARCHAR(20),
    ImageUrl VARCHAR(255),
    Status VARCHAR(20) DEFAULT 'available' NOT NULL,
    IsRecyclable BIT DEFAULT 0,
    ImportDate DATE,
    ExpirationDate DATE,
    CreatedAt DATETIME DEFAULT GETDATE(),
    UpdatedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT CK_Products_Price CHECK (Price >= 0),
    CONSTRAINT CK_Products_StockQuantity CHECK (StockQuantity >= 0),
    CONSTRAINT CK_Products_Status CHECK (Status IN ('available', 'out_of_stock', 'discontinued', 'hidden')),
    CONSTRAINT FK_Products_Sellers FOREIGN KEY (SellerID) REFERENCES Sellers(SellerID),
    CONSTRAINT FK_Products_Categories FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID)
);

-- Table ProductImages
CREATE TABLE ProductImages (
    ImageID INT IDENTITY(1,1) PRIMARY KEY,
    ProductID INT NOT NULL,
    ImageUrl VARCHAR(255) NOT NULL,
    CONSTRAINT FK_ProductImages_Products FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);

-- Table ShoppingCarts
CREATE TABLE ShoppingCarts (
    CartID INT IDENTITY(1,1) PRIMARY KEY,
    UserID INT NOT NULL,
    CreatedAt DATETIME DEFAULT GETDATE(),
    UpdatedAt DATETIME,
    CONSTRAINT FK_ShoppingCarts_Users FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Table CartItems
CREATE TABLE CartItems (
    CartItemID INT IDENTITY(1,1) PRIMARY KEY,
    CartID INT NOT NULL,
    ProductID INT NOT NULL,
    Quantity INT NOT NULL,
    AddedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT CK_CartItems_Quantity CHECK (Quantity > 0),
    CONSTRAINT FK_CartItems_ShoppingCarts FOREIGN KEY (CartID) REFERENCES ShoppingCarts(CartID),
    CONSTRAINT FK_CartItems_Products FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);

-- Table Wishlists
CREATE TABLE Wishlists (
    WishlistID INT IDENTITY(1,1) PRIMARY KEY,
    UserID INT NOT NULL,
    ProductID INT NOT NULL,
    AddedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT UQ_Wishlists_UserID_ProductID UNIQUE (UserID, ProductID),
    CONSTRAINT FK_Wishlists_Users FOREIGN KEY (UserID) REFERENCES Users(UserID),
    CONSTRAINT FK_Wishlists_Products FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);

-- Table DeliveryPartners
CREATE TABLE DeliveryPartners (
    PartnerID INT IDENTITY(1,1) PRIMARY KEY,
    Name VARCHAR(100) UNIQUE NOT NULL,
    ContactPerson VARCHAR(100),
    PhoneNumber VARCHAR(20) UNIQUE,
    Email VARCHAR(100) UNIQUE,
    ServiceArea TEXT,
    Rating DECIMAL(2,1),
    CreatedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT CK_DeliveryPartners_Rating CHECK (Rating >= 0 AND Rating <= 5)
);

-- Table Orders
CREATE TABLE Orders (
    OrderID INT IDENTITY(1,1) PRIMARY KEY,
    UserID INT NOT NULL,
    OrderDate DATETIME DEFAULT GETDATE(),
    TotalAmount DECIMAL(18,2) NOT NULL,
    Status VARCHAR(20) DEFAULT 'pending' NOT NULL,
    ShippingAddressID INT NOT NULL,
    BillingAddressID INT NOT NULL,
    DeliveryPartnerID INT,
    DeliveryInstructions VARCHAR(255),
    EstimatedDeliveryDate DATE,
    ActualDeliveryDate DATE,
    PaymentMethodID INT,
    Notes TEXT,
    CONSTRAINT CK_Orders_TotalAmount CHECK (TotalAmount >= 0),
    CONSTRAINT CK_Orders_Status CHECK (Status IN ('pending', 'processing', 'shipped', 'delivered', 'cancelled', 'refunded')),
    CONSTRAINT FK_Orders_Users FOREIGN KEY (UserID) REFERENCES Users(UserID),
    CONSTRAINT FK_Orders_ShippingAddress FOREIGN KEY (ShippingAddressID) REFERENCES Addresses(AddressID),
    CONSTRAINT FK_Orders_BillingAddress FOREIGN KEY (BillingAddressID) REFERENCES Addresses(AddressID),
    CONSTRAINT FK_Orders_DeliveryPartners FOREIGN KEY (DeliveryPartnerID) REFERENCES DeliveryPartners(PartnerID),
    CONSTRAINT FK_Orders_PaymentMethods FOREIGN KEY (PaymentMethodID) REFERENCES PaymentMethods(MethodID)
);

-- Table OrderItems
CREATE TABLE OrderItems (
    OrderItemID INT IDENTITY(1,1) PRIMARY KEY,
    OrderID INT NOT NULL,
    ProductID INT NOT NULL,
    Quantity INT NOT NULL,
    PriceAtPurchase DECIMAL(18,2) NOT NULL,
    SellerID INT NOT NULL,
    CONSTRAINT CK_OrderItems_Quantity CHECK (Quantity > 0),
    CONSTRAINT CK_OrderItems_PriceAtPurchase CHECK (PriceAtPurchase >= 0),
    CONSTRAINT FK_OrderItems_Orders FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),
    CONSTRAINT FK_OrderItems_Products FOREIGN KEY (ProductID) REFERENCES Products(ProductID),
    CONSTRAINT FK_OrderItems_Sellers FOREIGN KEY (SellerID) REFERENCES Sellers(SellerID)
);

-- Table PaymentMethods
CREATE TABLE PaymentMethods (
    MethodID INT IDENTITY(1,1) PRIMARY KEY,
    Name VARCHAR(50) UNIQUE NOT NULL,
    Description TEXT,
    IsActive BIT DEFAULT 1
);

-- Table Payments
CREATE TABLE Payments (
    PaymentID INT IDENTITY(1,1) PRIMARY KEY,
    OrderID INT UNIQUE NOT NULL,
    MethodID INT NOT NULL,
    Amount DECIMAL(18,2) NOT NULL,
    PaymentDate DATETIME DEFAULT GETDATE(),
    Status VARCHAR(20) DEFAULT 'pending' NOT NULL,
    TransactionIDGateway VARCHAR(255) UNIQUE,
    UserID INT NOT NULL,
    CONSTRAINT CK_Payments_Amount CHECK (Amount >= 0),
    CONSTRAINT CK_Payments_Status CHECK (Status IN ('pending', 'completed', 'failed', 'refunded')),
    CONSTRAINT FK_Payments_Orders FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),
    CONSTRAINT FK_Payments_PaymentMethods FOREIGN KEY (MethodID) REFERENCES PaymentMethods(MethodID),
    CONSTRAINT FK_Payments_Users FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Table ProductTransformations
CREATE TABLE ProductTransformations (
    TransformationID INT IDENTITY(1,1) PRIMARY KEY,
    SourceProductID INT NOT NULL,
    SourceImportDate DATE,
    SourceExpirationDate DATE,
    QuantityTransformed INT NOT NULL,
    DerivedProductID INT NOT NULL,
    DerivedQuantityProduced INT NOT NULL,
    TransformationDate DATETIME DEFAULT GETDATE(),
    TransformedByUserID INT,
    Notes TEXT,
    CONSTRAINT CK_ProductTransformations_QuantityTransformed CHECK (QuantityTransformed > 0),
    CONSTRAINT CK_ProductTransformations_DerivedQuantityProduced CHECK (DerivedQuantityProduced > 0),
    CONSTRAINT FK_ProductTransformations_SourceProduct FOREIGN KEY (SourceProductID) REFERENCES Products(ProductID),
    CONSTRAINT FK_ProductTransformations_DerivedProduct FOREIGN KEY (DerivedProductID) REFERENCES Products(ProductID),
    CONSTRAINT FK_ProductTransformations_User FOREIGN KEY (TransformedByUserID) REFERENCES Users(UserID)
);

-- Table ProductReviews
CREATE TABLE ProductReviews (
    ReviewID INT IDENTITY(1,1) PRIMARY KEY,
    ProductID INT NOT NULL,
    UserID INT NOT NULL,
    OrderItemID INT UNIQUE NOT NULL,
    Rating INT NOT NULL,
    Comment TEXT,
    ReviewDate DATETIME DEFAULT GETDATE(),
    Status VARCHAR(20) DEFAULT 'pending' NOT NULL,
    CONSTRAINT CK_ProductReviews_Rating CHECK (Rating >= 1 AND Rating <= 5),
    CONSTRAINT CK_ProductReviews_Status CHECK (Status IN ('pending', 'approved', 'rejected')),
    CONSTRAINT FK_ProductReviews_Products FOREIGN KEY (ProductID) REFERENCES Products(ProductID),
    CONSTRAINT FK_ProductReviews_Users FOREIGN KEY (UserID) REFERENCES Users(UserID),
    CONSTRAINT FK_ProductReviews_OrderItems FOREIGN KEY (OrderItemID) REFERENCES OrderItems(OrderItemID)
);

-- Table Sales
CREATE TABLE Sales (
    SaleID INT IDENTITY(1,1) PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    Description TEXT,
    DiscountType VARCHAR(20) NOT NULL,
    DiscountValue DECIMAL(18,2) NOT NULL,
    StartDate DATETIME NOT NULL,
    EndDate DATETIME NOT NULL,
    CategoryID INT,
    Status VARCHAR(20) DEFAULT 'active' NOT NULL,
    CreatedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT CK_Sales_DiscountType CHECK (DiscountType IN ('percentage', 'fixed_amount')),
    CONSTRAINT CK_Sales_DiscountValue CHECK (DiscountValue >= 0),
    CONSTRAINT CK_Sales_Status CHECK (Status IN ('active', 'inactive', 'scheduled', 'ended')),
    CONSTRAINT FK_Sales_Categories FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID)
);

-- Table Shipments
CREATE TABLE Shipments (
    ShipmentID INT IDENTITY(1,1) PRIMARY KEY,
    OrderID INT NOT NULL,
    DeliveryPartnerID INT,
    TrackingNumber VARCHAR(100) UNIQUE,
    ShippingDate DATETIME,
    EstimatedDeliveryDate DATE,
    ActualDeliveryDate DATE,
    Status VARCHAR(50) NOT NULL,
    ShippingCost DECIMAL(10,2),
    ShippingAddressID INT NOT NULL,
    CONSTRAINT CK_Shipments_Status CHECK (Status IN ('pending_pickup', 'in_transit', 'out_for_delivery', 'delivered', 'failed_delivery', 'returned')),
    CONSTRAINT FK_Shipments_Orders FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),
    CONSTRAINT FK_Shipments_DeliveryPartners FOREIGN KEY (DeliveryPartnerID) REFERENCES DeliveryPartners(PartnerID),
    CONSTRAINT FK_Shipments_ShippingAddress FOREIGN KEY (ShippingAddressID) REFERENCES Addresses(AddressID)
);

-- Table Coupons
CREATE TABLE Coupons (
    CouponID INT IDENTITY(1,1) PRIMARY KEY,
    Code VARCHAR(50) UNIQUE NOT NULL,
    Description TEXT,
    DiscountType VARCHAR(20) NOT NULL,
    DiscountValue DECIMAL(18,2),
    StartDate DATETIME NOT NULL,
    ExpirationDate DATETIME NOT NULL,
    IsFreeShipping BIT DEFAULT 0,
    QuantityAvailable INT,
    UsageLimitPerCustomer INT,
    CategoryID INT,
    MinOrderAmount DECIMAL(18,2),
    MaxDiscountAmount DECIMAL(18,2),
    Status VARCHAR(20) DEFAULT 'active' NOT NULL,
    CreatedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT CK_Coupons_DiscountType CHECK (DiscountType IN ('percentage', 'fixed_amount', 'free_shipping')),
    CONSTRAINT CK_Coupons_DiscountValue CHECK (DiscountValue IS NULL OR DiscountValue >= 0),
    CONSTRAINT CK_Coupons_QuantityAvailable CHECK (QuantityAvailable IS NULL OR QuantityAvailable >= 0),
    CONSTRAINT CK_Coupons_UsageLimitPerCustomer CHECK (UsageLimitPerCustomer IS NULL OR UsageLimitPerCustomer >= 0),
    CONSTRAINT CK_Coupons_MinOrderAmount CHECK (MinOrderAmount IS NULL OR MinOrderAmount >= 0),
    CONSTRAINT CK_Coupons_MaxDiscountAmount CHECK (MaxDiscountAmount IS NULL OR MaxDiscountAmount >= 0),
    CONSTRAINT CK_Coupons_Status CHECK (Status IN ('active', 'inactive', 'expired')),
    CONSTRAINT FK_Coupons_Categories FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID)
);

-- Table Notifications
CREATE TABLE Notifications (
    NotificationID INT IDENTITY(1,1) PRIMARY KEY,
    UserID INT NOT NULL,
    Title VARCHAR(255) NOT NULL,
    Content TEXT NOT NULL,
    Status VARCHAR(20) DEFAULT 'unread' NOT NULL,
    CreatedAt DATETIME DEFAULT GETDATE(),
    CONSTRAINT CK_Notifications_Status CHECK (Status IN ('unread', 'read')),
    CONSTRAINT FK_Notifications_Users FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Table Admins
CREATE TABLE Admins (
    AdminID INT PRIMARY KEY,
    Permissions TEXT,
    LastActionLog TEXT,
    CONSTRAINT FK_Admins_Users FOREIGN KEY (AdminID) REFERENCES Users(UserID)
);
`;

document.addEventListener('DOMContentLoaded', function () {
    const tabs = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    const entityList = document.getElementById('entityList');
    const entityDetail = document.getElementById('entityDetail');
    const relationshipList = document.getElementById('relationshipList');
    const relationshipDetail = document.getElementById('relationshipDetail');
    const constraintsList = document.getElementById('constraintsList');
    const mobileMenuButton = document.getElementById('mobileMenuButton');
    const mainNav = document.getElementById('mainNav');
    const sqlCodeBlock = document.getElementById('sqlCodeBlock');
    const copySqlButton = document.getElementById('copySqlButton');

    mobileMenuButton.addEventListener('click', () => {
        mainNav.classList.toggle('hidden');
        mainNav.classList.toggle('md:flex');
    });
    
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active', 'text-sky-600', 'border-sky-600'));
            tabs.forEach(t => t.classList.add('text-stone-100'));
            tab.classList.add('active', 'text-sky-600', 'border-sky-600');
            tab.classList.remove('text-stone-100');

            tabContents.forEach(content => content.classList.remove('active'));
            document.getElementById(tab.dataset.tab).classList.add('active');

            if (window.innerWidth < 768 && !mainNav.classList.contains('hidden')) {
                 mainNav.classList.add('hidden');
            }
        });
    });
    const initialActiveTab = document.querySelector('.tab-button[data-tab="entities"]');
    if (initialActiveTab) {
        initialActiveTab.classList.add('active', 'text-sky-600', 'border-sky-600');
        initialActiveTab.classList.remove('text-stone-100');
        document.getElementById('entities').classList.add('active');
    }

    function populateEntityList() {
        entityList.innerHTML = '';
        Object.keys(entitiesData).forEach(key => {
            const listItem = document.createElement('li');
            listItem.textContent = entitiesData[key].name;
            listItem.className = 'entity-list-item p-2 hover:bg-emerald-50 cursor-pointer rounded transition-colors duration-150';
            listItem.dataset.entityKey = key;
            listItem.addEventListener('click', () => {
                document.querySelectorAll('.entity-list-item').forEach(item => item.classList.remove('active'));
                listItem.classList.add('active');
                displayEntityDetails(key);
            });
            entityList.appendChild(listItem);
        });
    }

    function displayEntityDetails(key) {
        const entity = entitiesData[key];
        if (!entity) {
            entityDetail.innerHTML = '<p class="text-stone-500 italic">Kh√¥ng t√¨m th·∫•y th√¥ng tin th·ª±c th·ªÉ.</p>';
            return;
        }
        let attributesHtml = entity.attributes.map(attr => `
            <tr class="hover:bg-stone-50">
                <td class="py-2 px-3 border-b border-stone-200 font-medium text-stone-700">${attr.name}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-sky-600">${attr.type}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-stone-600">${attr.details}</td>
            </tr>
        `).join('');

        entityDetail.innerHTML = `
            <h3 class="text-xl font-semibold text-emerald-700 mb-2">${entity.name}</h3>
            <p class="text-sm text-stone-600 mb-4">${entity.description}</p>
            <h4 class="text-md font-semibold text-emerald-600 mt-4 mb-2">Thu·ªôc t√≠nh:</h4>
            <div class="overflow-x-auto shadow rounded-md">
                <table class="min-w-full bg-white border border-stone-200">
                    <thead class="bg-stone-100">
                        <tr>
                            <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">T√™n Thu·ªôc T√≠nh</th>
                            <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">Lo·∫°i (PK/FK/R√†ng bu·ªôc)</th>
                            <th class="py-2 px-3 border-b border-stone-200 text-left text-xs font-semibold text-stone-600 uppercase tracking-wider">M√¥ T·∫£</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-stone-200">
                        ${attributesHtml}
                    </tbody>
                </table>
            </div>
        `;
    }

    function populateRelationshipList() {
        relationshipList.innerHTML = '';
        relationshipsData.forEach((rel, index) => {
            const listItem = document.createElement('li');
            listItem.textContent = rel.name;
            listItem.className = 'relationship-list-item p-2 hover:bg-sky-50 cursor-pointer rounded transition-colors duration-150';
            listItem.dataset.relIndex = index;
            listItem.addEventListener('click', () => {
                document.querySelectorAll('.relationship-list-item').forEach(item => item.classList.remove('active'));
                listItem.classList.add('active');
                displayRelationshipDetails(index);
            });
            relationshipList.appendChild(listItem);
        });
    }

    function displayRelationshipDetails(index) {
        const rel = relationshipsData[index];
        if (!rel) {
            relationshipDetail.innerHTML = '<p class="text-stone-500 italic">Kh√¥ng t√¨m th·∫•y th√¥ng tin m·ªëi quan h·ªá.</p>';
            return;
        }
        relationshipDetail.innerHTML = `
            <h3 class="text-xl font-semibold text-sky-700 mb-2">${rel.name}</h3>
            <p class="text-sm text-stone-600 mb-1"><strong class="text-stone-700">Lo·∫°i:</strong> ${rel.type}</p>
            <p class="text-sm text-stone-600 mb-1"><strong class="text-stone-700">T·ª´ Th·ª±c th·ªÉ:</strong> ${rel.from}</p>
            <p class="text-sm text-stone-600 mb-3"><strong class="text-stone-700">T·ªõi Th·ª±c th·ªÉ:</strong> ${rel.to}</p>
            <p class="text-sm text-stone-600 leading-relaxed">${rel.details}</p>
        `;
    }
    
    function populateConstraints() {
        constraintsList.innerHTML = '';
        constraintsData.forEach(constraint => {
            const constraintDiv = document.createElement('div');
            constraintDiv.className = 'p-5 border border-blue-200 rounded-lg bg-blue-50 shadow';
            let examplesHtml = constraint.examples.map(ex => `<li class="text-sm text-stone-700 bg-white p-2 rounded border border-blue-100 shadow-sm">${ex}</li>`).join('');
            constraintDiv.innerHTML = `
                <h3 class="text-xl font-semibold text-blue-700 mb-2">${constraint.name}</h3>
                <p class="text-sm text-stone-700 mb-3 leading-relaxed">${constraint.description}</p>
                <h4 class="text-md font-semibold text-blue-600 mb-2">C√°ch ho·∫°t ƒë·ªông:</h4>
                <p class="text-sm text-stone-700 mb-4 leading-relaxed">${constraint.howItWorks}</p>
                <h4 class="text-md font-semibold text-blue-600 mb-2">V√≠ d·ª•:</h4>
                <ul class="list-none space-y-2">
                    ${examplesHtml}
                </ul>
            `;
            constraintsList.appendChild(constraintDiv);
        });
    }

    function populateExpirationRepurposing() {
        const data = expirationRepurposingData;
        document.getElementById('problem-title').textContent = data.problem.title;
        document.getElementById('problem-description').textContent = data.problem.description;

        document.getElementById('expiration-solution-title').textContent = data.expirationSolution.title;
        document.getElementById('expiration-solution-description').textContent = data.expirationSolution.description;
        document.getElementById('products-hsd-table-name').textContent = data.expirationSolution.table.name;
        const productsHsdAttributesBody = document.getElementById('products-hsd-attributes');
        productsHsdAttributesBody.innerHTML = data.expirationSolution.table.attributes.map(attr => `
            <tr class="hover:bg-stone-50">
                <td class="py-2 px-3 border-b border-stone-200 font-medium text-stone-700">${attr.name}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-sky-600">${attr.type}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-stone-600">${attr.details}</td>
            </tr>
        `).join('');
        document.getElementById('expiration-solution-explanation').innerHTML = data.expirationSolution.explanation;

        document.getElementById('repurposing-solution-title').textContent = data.repurposingSolution.title;
        document.getElementById('repurposing-solution-description').textContent = data.repurposingSolution.description;
        document.getElementById('product-transformation-table-name').textContent = data.repurposingSolution.table.name;
        const productTransformationAttributesBody = document.getElementById('product-transformation-attributes');
        productTransformationAttributesBody.innerHTML = data.repurposingSolution.table.attributes.map(attr => `
            <tr class="hover:bg-stone-50">
                <td class="py-2 px-3 border-b border-stone-200 font-medium text-stone-700">${attr.name}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-sky-600">${attr.type}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-stone-600">${attr.details}</td>
            </tr>
        `).join('');
        document.getElementById('repurposing-solution-explanation').innerHTML = data.repurposingSolution.explanation;
        
        document.getElementById('need-for-new-tables-title').textContent = data.needForNewTables.title;
        document.getElementById('need-for-new-tables-explanation').innerHTML = data.needForNewTables.explanation;
    }

    function populateProductReviews() {
        const attributesBody = document.getElementById('product-reviews-attributes');
        attributesBody.innerHTML = entitiesData.ProductReviews.attributes.map(attr => `
            <tr class="hover:bg-stone-50">
                <td class="py-2 px-3 border-b border-stone-200 font-medium text-stone-700">${attr.name}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-sky-600">${attr.type}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-stone-600">${attr.details}</td>
            </tr>
        `).join('');
    }

    function populatePromotionsCoupons() {
        const salesAttributesBody = document.getElementById('sales-attributes');
        salesAttributesBody.innerHTML = entitiesData.Sales.attributes.map(attr => `
            <tr class="hover:bg-stone-50">
                <td class="py-2 px-3 border-b border-stone-200 font-medium text-stone-700">${attr.name}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-sky-600">${attr.type}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-stone-600">${attr.details}</td>
            </tr>
        `).join('');

        const couponsAttributesBody = document.getElementById('coupons-attributes');
        couponsAttributesBody.innerHTML = entitiesData.Coupons.attributes.map(attr => `
            <tr class="hover:bg-stone-50">
                <td class="py-2 px-3 border-b border-stone-200 font-medium text-stone-700">${attr.name}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-sky-600">${attr.type}</td>
                <td class="py-2 px-3 border-b border-stone-200 text-sm text-stone-600">${attr.details}</td>
            </tr>
        `).join('');
    }

    function populateSqlSchema() {
        sqlCodeBlock.textContent = sqlSchemaData;
    }

    copySqlButton.addEventListener('click', () => {
        const textToCopy = sqlCodeBlock.textContent;
        navigator.clipboard.writeText(textToCopy).then(() => {
            const originalText = copySqlButton.textContent;
            copySqlButton.textContent = 'ƒê√£ sao ch√©p!';
            setTimeout(() => {
                copySqlButton.textContent = originalText;
            }, 2000);
        }).catch(err => {
            console.error('Failed to copy text: ', err);
            // Fallback for older browsers or if writeText fails
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            textArea.style.position = 'fixed'; // Avoid scrolling to bottom
            textArea.style.left = '-9999px'; // Hide from view
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                const originalText = copySqlButton.textContent;
                copySqlButton.textContent = 'ƒê√£ sao ch√©p!';
                setTimeout(() => {
                    copySqlButton.textContent = originalText;
                }, 2000);
            } catch (e) {
                console.error('Fallback: Could not copy text', e);
            }
            document.body.removeChild(textArea);
        });
    });

    populateEntityList();
    populateRelationshipList();
    populateConstraints();
    populateExpirationRepurposing();
    populateProductReviews();
    populatePromotionsCoupons();
    populateSqlSchema();
});
</script>
</body>
</html>
