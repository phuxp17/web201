<!-- <!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code free</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1e293b, #0f172a);
            color: #f8fafc;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            background: rgba(30, 41, 59, 0.9);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            text-align: center;
            max-width: 320px;
            width: 100%;
            border: 1px solid rgba(148, 163, 184, 0.3);
        }

        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #64748b;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 15px;
            outline: none;
            background: #0f172a;
            color: #f8fafc;
            transition: border 0.2s;
        }

        input::placeholder {
            color: #94a3b8;
        }

        input:focus {
            border-color: #3b82f6;
        }

        button {
            background-color: #3b82f6;
            color: white;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s, transform 0.1s;
        }

        button:hover {
            background-color: #2563eb;
            transform: scale(1.05);
        }

        img {
            display: block;
            margin: 15px auto 0;
            border-radius: 8px;
            background: white;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <input id="qr" placeholder="Enter url">
        <img alt="QR Code" id="qrimg">
        <button 
            onclick="qrimg.src='https://api.qrserver.com/v1/create-qr-code/?size=150x150&data='+encodeURIComponent(qr.value)">
            Generate
        </button>
    </div>
</body>
</html>
 -->
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>V≈© Tr·ª• Th√¥ng Minh (Hybrid)</title>
    
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #020205;
            font-family: 'Segoe UI', sans-serif;
            touch-action: none; /* Ch·∫∑n cu·ªôn trang tr√™n mobile */
            user-select: none;
        }

        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }

        /* Giao di·ªán Modal Th√¥ng ƒëi·ªáp */
        #modal {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: rgba(15, 20, 40, 0.95);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            color: #fff;
            border: 1px solid rgba(0, 255, 136, 0.3);
            box-shadow: 0 0 50px rgba(0, 255, 136, 0.2);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 100;
            width: 80%;
            max-width: 400px;
            pointer-events: none; /* M·∫∑c ƒë·ªãnh kh√¥ng ch·∫∑n chu·ªôt ƒë·ªÉ animation m∆∞·ª£t */
        }

        #modal.active {
            opacity: 1; visibility: visible;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto;
        }

        #modal h2 { margin: 0 0 15px 0; color: #00ff88; text-transform: uppercase; font-size: 1.2rem; }
        #modal p { font-size: 1.4rem; font-weight: bold; color: #e0f7fa; line-height: 1.4; }
        #modal .hint { font-size: 0.9rem; color: #888; margin-top: 20px; font-weight: normal; }

        /* M√†n h√¨nh ch·ªù / H∆∞·ªõng d·∫´n */
        #overlay {
            position: absolute;
            top: 20px; left: 0; width: 100%;
            text-align: center;
            pointer-events: none;
            z-index: 50;
        }

        .badge {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            color: #00ff88;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            backdrop-filter: blur(5px);
        }

        /* Video ·∫©n cho PC */
        .input_video { display: none; }
        
        /* Hi·ªáu ·ª©ng load */
        #loader {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #00ff88; font-family: monospace;
        }
    </style>
</head>
<body>

    <div id="loader">ƒêang ph√¢n t√≠ch thi·∫øt b·ªã...</div>

    <div id="overlay">
        <div class="badge" id="device-status">ƒêang kh·ªüi t·∫°o...</div>
        <div style="margin-top:10px; color: rgba(255,255,255,0.6); font-size: 0.8rem;" id="guide-text"></div>
    </div>

    <video class="input_video" playsinline></video>
    <canvas id="sky"></canvas>

    <div id="modal">
        <h2>Th√¥ng ƒêi·ªáp V≈© Tr·ª•</h2>
        <p id="msg-content">...</p>
        <div class="hint" id="modal-hint">Ch·∫°m ra ngo√†i ƒë·ªÉ ƒë√≥ng</div>
    </div>

    <!-- Scripts MediaPipe (Ch·ªâ t·∫£i n·∫øu c·∫ßn, nh∆∞ng ƒë·ªÉ ƒë∆°n gi·∫£n ta ch√®n link s·∫µn, JS s·∫Ω quy·∫øt ƒë·ªãnh ch·∫°y hay kh√¥ng) -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>

    <script>
        // --- C·∫§U H√åNH & TR·∫†NG TH√ÅI ---
        const canvas = document.getElementById('sky');
        const ctx = canvas.getContext('2d');
        const modal = document.getElementById('modal');
        const msgContent = document.getElementById('msg-content');
        const statusBadge = document.getElementById('device-status');
        const guideText = document.getElementById('guide-text');
        const modalHint = document.getElementById('modal-hint');
        const loader = document.getElementById('loader');

        let width, height;
        let stars = [];
        let globalRotation = 0;
        
        // Ph√°t hi·ªán thi·∫øt b·ªã (ƒê∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£)
        // Coi l√† Mobile n·∫øu m√†n h√¨nh nh·ªè HO·∫∂C c√≥ h·ªó tr·ª£ c·∫£m ·ª©ng
        const isMobile = (window.innerWidth < 1000) || ('ontouchstart' in window);

        // Tr·∫°ng th√°i ƒëi·ªÅu khi·ªÉn
        const state = {
            mode: isMobile ? 'TOUCH' : 'WEBCAM', // TOUCH ho·∫∑c WEBCAM
            cursorX: -100,
            cursorY: -100,
            active: false, // C√≥ ƒëang t∆∞∆°ng t√°c hay kh√¥ng
            rotationSpeed: 0.0005,
            hoverIndex: -1
        };

        const messages = [
            "B·∫°n l√† duy nh·∫•t!", "H√£y c∆∞·ªùi l√™n n√†o.", "C∆° h·ªôi ƒëang ƒë·∫øn.",
            "B√¨nh y√™n trong t√¢m h·ªìn.", "S·ª©c m·∫°nh n·ªôi t·∫°i.", "V≈© tr·ª• y√™u th∆∞∆°ng b·∫°n.",
            "ƒê·ª´ng b·ªè cu·ªôc!", "H·∫°nh ph√∫c ·ªü ƒë√¢y."
        ];

        // --- H·ªÜ TH·ªêNG SAO (T·ªêI ∆ØU H√ìA) ---
        class Star {
            constructor() {
                this.reset();
            }
            
            reset() {
                // R·∫£i sao r·ªông h∆°n m√†n h√¨nh ƒë·ªÉ khi xoay kh√¥ng b·ªã h·ªïng
                const r = Math.max(width, height) * (0.1 + Math.random() * 1.3);
                const theta = Math.random() * Math.PI * 2;
                
                this.x = r * Math.cos(theta); // T·ªça ƒë·ªô g·ªëc (ch∆∞a xoay)
                this.y = r * Math.sin(theta);
                
                this.size = Math.random() * 2;
                this.baseSize = this.size;
                
                // Sao ƒë·∫∑c bi·ªát (C√≥ th√¥ng ƒëi·ªáp)
                // Mobile: Sao to h∆°n, √≠t sao h∆°n ƒë·ªÉ d·ªÖ b·∫•m
                this.isSpecial = Math.random() < (isMobile ? 0.15 : 0.1); 
                if (this.isSpecial) {
                    this.size = isMobile ? 8 + Math.random() * 4 : 5 + Math.random() * 3;
                    this.baseSize = this.size;
                    this.color = `hsl(${Math.random() * 60 + 190}, 100%, 80%)`;
                } else {
                    this.color = `rgba(255, 255, 255, ${Math.random() * 0.7 + 0.3})`;
                }
                
                this.blinkOffset = Math.random() * 100;
            }

            draw(ctx, centerX, centerY, cosRot, sinRot, frame) {
                // T√≠nh to√°n t·ªça ƒë·ªô xoay (Rotation Matrix)
                // x' = x*cos - y*sin
                // y' = x*sin + y*cos
                const rotX = this.x * cosRot - this.y * sinRot;
                const rotY = this.x * sinRot + this.y * cosRot;

                const screenX = centerX + rotX;
                const screenY = centerY + rotY;

                // Hi·ªáu ·ª©ng nh·∫•p nh√°y
                const blink = Math.sin((frame + this.blinkOffset) * 0.05);
                const currentSize = this.isSpecial 
                    ? this.baseSize + blink * 2 
                    : this.baseSize + blink * 0.5;

                ctx.beginPath();
                ctx.arc(screenX, screenY, Math.max(0, currentSize), 0, Math.PI * 2);
                
                if (this.isSpecial) {
                    // Glow effect (ch·ªâ v·∫Ω cho sao ƒë·∫∑c bi·ªát ƒë·ªÉ t·ªëi ∆∞u)
                    ctx.fillStyle = "#fff";
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = this.color;
                } else {
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 0;
                }
                ctx.fill();

                // Tr·∫£ v·ªÅ t·ªça ƒë·ªô m√†n h√¨nh ƒë·ªÉ ki·ªÉm tra va ch·∫°m (ch·ªâ sao ƒë·∫∑c bi·ªát)
                if (this.isSpecial) return { x: screenX, y: screenY };
                return null;
            }
        }

        // --- KH·ªûI T·∫†O H·ªÜ TH·ªêNG ---
        function init() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            
            // S·ªë l∆∞·ª£ng sao: Mobile √≠t h∆°n ƒë·ªÉ m∆∞·ª£t (150), PC nhi·ªÅu h∆°n (300)
            const starCount = isMobile ? 150 : 350;
            stars = [];
            for (let i = 0; i < starCount; i++) stars.push(new Star());

            loader.style.display = 'none';

            if (isMobile) {
                setupMobileMode();
            } else {
                setupDesktopMode();
            }
        }

        // --- CH·∫æ ƒê·ªò 1: MOBILE (C·∫¢M ·ª®NG) ---
        function setupMobileMode() {
            statusBadge.innerText = "üì± Ch·∫ø ƒë·ªô C·∫£m ·ª®ng";
            guideText.innerText = "Ch·∫°m v√†o sao ƒë·ªÉ m·ªü ‚Ä¢ K√©o ƒë·ªÉ xoay";
            modalHint.innerText = "Ch·∫°m ra ngo√†i ƒë·ªÉ ƒë√≥ng";

            // X·ª≠ l√Ω Touch
            let startX = 0;
            
            canvas.addEventListener('touchstart', (e) => {
                const t = e.touches[0];
                state.cursorX = t.clientX;
                state.cursorY = t.clientY;
                startX = t.clientX;
                state.active = true;
                
                // Ki·ªÉm tra click sao
                checkInteraction(true); 
            }, {passive: false});

            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault(); // Ch·∫∑n k√©o trang
                const t = e.touches[0];
                state.cursorX = t.clientX;
                state.cursorY = t.clientY;

                // Xoay d·ª±a tr√™n di chuy·ªÉn ng√≥n tay
                const deltaX = t.clientX - startX;
                state.rotationSpeed = deltaX * 0.0001; // Nh·∫°y h∆°n
            }, {passive: false});

            canvas.addEventListener('touchend', () => {
                state.active = false;
                // Tr√¥i nh·∫π khi th·∫£ tay
                state.rotationSpeed = 0.0005;
            });
        }

        // --- CH·∫æ ƒê·ªò 2: DESKTOP (WEBCAM AI) ---
        async function setupDesktopMode() {
            statusBadge.innerText = "üíª Ch·∫ø ƒë·ªô AI Camera";
            guideText.innerText = "üñêÔ∏è X√≤e tay: M·ªü ‚Ä¢ ‚úä N·∫Øm tay: ƒê√≥ng ‚Ä¢ Di chuy·ªÉn tay ƒë·ªÉ xoay";
            modalHint.innerText = "N·∫Øm tay l·∫°i ƒë·ªÉ ƒë√≥ng";

            const videoElement = document.querySelector('.input_video');
            
            // H√†m x·ª≠ l√Ω k·∫øt qu·∫£ AI
            function onResults(results) {
                if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                    const lm = results.multiHandLandmarks[0];
                    const indexTip = lm[8]; // Ng√≥n tr·ªè

                    // 1. C·∫≠p nh·∫≠t v·ªã tr√≠ con tr·ªè (L·∫≠t g∆∞∆°ng)
                    state.cursorX = (1 - indexTip.x) * width;
                    state.cursorY = indexTip.y * height;
                    state.active = true;

                    // 2. X·ª≠ l√Ω C·ª≠ ch·ªâ (Gesture)
                    // Kho·∫£ng c√°ch ƒê·∫ßu c√°i (4) - ƒê·∫ßu tr·ªè (8) vs Kh·ªõp c√°i (3) - Kh·ªõp tr·ªè (6)
                    // Logic ƒë∆°n gi·∫£n: Kho·∫£ng c√°ch ƒë·∫ßu ng√≥n c√°i v√† tr·ªè xa nhau -> M·ªü. G·∫ßn -> ƒê√≥ng.
                    const d = Math.hypot(lm[4].x - lm[8].x, lm[4].y - lm[8].y);
                    const isClosed = d < 0.05; // Ng∆∞·ª°ng n·∫Øm tay

                    if (isClosed) {
                        // N·∫Øm tay -> ƒê√≥ng modal
                        closeModal();
                    } else {
                        // M·ªü tay -> Ki·ªÉm tra ch·ªçn sao
                        checkInteraction(false); // False: Kh√¥ng b·∫Øt bu·ªôc click, ch·ªâ c·∫ßn hover + open
                    }

                    // 3. X·ª≠ l√Ω Xoay (D·ª±a tr√™n v·ªã tr√≠ tay so v·ªõi t√¢m)
                    const cx = width / 2;
                    const deadZone = 150; // V√πng ch·∫øt ·ªü gi·ªØa
                    if (state.cursorX < cx - deadZone) {
                        state.rotationSpeed = -0.003 * ((cx - deadZone - state.cursorX) / 200);
                    } else if (state.cursorX > cx + deadZone) {
                        state.rotationSpeed = 0.003 * ((state.cursorX - (cx + deadZone)) / 200);
                    } else {
                        state.rotationSpeed = 0;
                    }

                } else {
                    state.active = false;
                    state.rotationSpeed = 0.0005; // Tr√¥i t·ª± nhi√™n
                }
            }

            // Kh·ªüi t·∫°o MediaPipe
            try {
                const hands = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
                hands.setOptions({
                    maxNumHands: 1,
                    modelComplexity: 1, // M√°y t√≠nh m·∫°nh n√™n d√πng model t·ªët h∆°n
                    minDetectionConfidence: 0.5,
                    minTrackingConfidence: 0.5
                });
                hands.onResults(onResults);

                const camera = new Camera(videoElement, {
                    onFrame: async () => { await hands.send({image: videoElement}); },
                    width: 640, height: 480
                });
                await camera.start();
            } catch (e) {
                console.error(e);
                alert("Kh√¥ng t√¨m th·∫•y Camera. Chuy·ªÉn sang d√πng chu·ªôt.");
                // Fallback sang chu·ªôt n·∫øu l·ªói cam
                window.addEventListener('mousemove', e => {
                    state.cursorX = e.clientX;
                    state.cursorY = e.clientY;
                    state.active = true;
                });
                window.addEventListener('click', () => checkInteraction(true));
            }
        }

        // --- LOGIC T∆Ø∆†NG T√ÅC CHUNG ---
        function checkInteraction(isClickEvent) {
            // N·∫øu modal ƒëang m·ªü, kh√¥ng check sao
            if (modal.classList.contains('active')) {
                if (isClickEvent && isMobile) closeModal();
                return;
            }

            // Ki·ªÉm tra va ch·∫°m v·ªõi sao
            if (state.hoverIndex !== -1) {
                openModal();
            }
        }

        function openModal() {
            if (modal.classList.contains('active')) return;
            msgContent.innerText = messages[Math.floor(Math.random() * messages.length)];
            modal.classList.add('active');
            createExplosion(state.cursorX, state.cursorY);
        }

        function closeModal() {
            modal.classList.remove('active');
        }

        function createExplosion(x, y) {
            const burst = document.createElement('div');
            Object.assign(burst.style, {
                position: 'absolute', left: x + 'px', top: y + 'px',
                width: '10px', height: '10px', background: '#fff',
                borderRadius: '50%', boxShadow: '0 0 30px 10px #00ff88',
                transform: 'translate(-50%,-50%)', pointerEvents: 'none', zIndex: 200,
                transition: 'all 0.5s ease-out'
            });
            document.body.appendChild(burst);
            requestAnimationFrame(() => {
                burst.style.transform = 'translate(-50%,-50%) scale(5)';
                burst.style.opacity = 0;
            });
            setTimeout(() => burst.remove(), 500);
        }

        // --- RENDER LOOP (T·ªêI ∆ØU H√ìA) ---
        let frame = 0;
        function animate() {
            frame++;
            
            // 1. X√≥a m√†n h√¨nh
            ctx.fillStyle = "#020205";
            ctx.fillRect(0, 0, width, height);

            // 2. T√≠nh to√°n ma tr·∫≠n xoay (Ch·ªâ t√≠nh 1 l·∫ßn m·ªói frame)
            globalRotation += state.rotationSpeed;
            const cx = width / 2;
            const cy = height / 2;
            const cosRot = Math.cos(globalRotation);
            const sinRot = Math.sin(globalRotation);

            // 3. V·∫Ω Sao & Ki·ªÉm tra va ch·∫°m
            state.hoverIndex = -1; // Reset hover
            let closestDist = 999;
            const hitRadius = isMobile ? 50 : 30; // Mobile d·ªÖ b·∫•m h∆°n

            // Duy·ªát ng∆∞·ª£c m·∫£ng ƒë·ªÉ sao v·∫Ω sau ƒë√® l√™n sao tr∆∞·ªõc (chi·ªÅu s√¢u)
            for (let i = 0; i < stars.length; i++) {
                const s = stars[i];
                const screenPos = s.draw(ctx, cx, cy, cosRot, sinRot, frame);

                // N·∫øu l√† sao ƒë·∫∑c bi·ªát v√† ƒëang c√≥ con tr·ªè ho·∫°t ƒë·ªông
                if (screenPos && state.active && !modal.classList.contains('active')) {
                    const dist = Math.hypot(screenPos.x - state.cursorX, screenPos.y - state.cursorY);
                    if (dist < hitRadius && dist < closestDist) {
                        closestDist = dist;
                        state.hoverIndex = i;
                    }
                }
            }

            // 4. V·∫Ω Con tr·ªè (Cursor)
            if (state.active) {
                ctx.beginPath();
                ctx.arc(state.cursorX, state.cursorY, hitRadius / 2, 0, Math.PI * 2);
                
                // ƒê·ªïi m√†u n·∫øu tr√∫ng sao
                if (state.hoverIndex !== -1) {
                    ctx.fillStyle = "rgba(255, 255, 255, 0.3)";
                    ctx.strokeStyle = "#fff";
                    ctx.lineWidth = 3;
                    document.body.style.cursor = 'pointer';
                } else {
                    ctx.fillStyle = isMobile ? "rgba(0, 255, 136, 0.2)" : "rgba(0, 150, 255, 0.2)";
                    ctx.strokeStyle = isMobile ? "#00ff88" : "#00ccff";
                    ctx.lineWidth = 2;
                    document.body.style.cursor = 'default';
                }
                
                ctx.fill();
                ctx.stroke();
            }

            requestAnimationFrame(animate);
        }

        // Kh·ªüi ch·∫°y
        window.addEventListener('resize', init);
        window.onload = () => {
            init();
            animate();
        };

    </script>
</body>
</html>
