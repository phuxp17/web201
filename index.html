<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√°m Ph√° Thi·∫øt K·∫ø DB Ecommerce</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Visualization & Content Choices:
        - Introduction: Text summaries. Goal: Inform. Method: HTML text blocks.
        - Core E-commerce Entities (Sec 2.1, 4): Interactive HTML lists/tables for Users, Products, Orders, etc. Goal: Organize/Inform. Method: HTML + JS toggle for details. Interaction: Click to expand.
        - RBAC Concepts (Sec 3, 5): Text summaries, interactive lists for Roles, Permissions. Goal: Inform/Organize. Method: HTML + JS. Interaction: Click to see role details/permissions.
        - RBAC Roles (Sec 6): Detailed views for Customer, Seller, Admin, Staff, Farm roles with their permissions. Goal: Compare/Inform. Method: HTML + JS. Interaction: Select role to view details.
        - RBAC Charts (Conceptual):
            - Role Distribution: Goal: Inform. Viz: Pie Chart (Chart.js). Interaction: Hover for details. Data: Sample. Justification: Visual overview of user types.
            - Permissions per Module: Goal: Inform. Viz: Bar Chart (Chart.js). Interaction: Hover for details. Data: Sample based on report. Justification: Illustrate permission granularity.
        - Farm Produce Management (Sec 7): Text summaries, interactive HTML lists for Farms, FarmProducts, Batches, Inventory. Visual flow representation (HTML/CSS). Goal: Inform/Organize. Method: HTML + JS. Interaction: Click to expand table details.
        - Integrated Schema (Sec 8): Simplified interactive representation of key table relationships using HTML/CSS. Goal: Relationships. Method: HTML + JS click to highlight. Interaction: Click table to see related tables.
        - Best Practices & Conclusion (Sec 9, 10): Text summaries. Goal: Inform. Method: HTML text blocks.
        - NO SVG graphics used. NO Mermaid JS used. All diagrams/flows via HTML/CSS/Tailwind. Charts via Chart.js. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .table-diagram-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-start;
        }
        .table-block {
            border: 1px solid #e2e8f0; /* slate-200 */
            border-radius: 0.375rem; /* rounded-md */
            padding: 1rem;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
        }
        .table-block:hover, .table-block.highlighted {
            border-color: #0284c7; /* sky-600 */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .table-block h4 {
            font-weight: 600;
            color: #1e293b; /* slate-800 */
        }
        .table-block ul {
            list-style-type: none;
            padding-left: 0;
            font-size: 0.875rem; /* text-sm */
            color: #475569; /* slate-600 */
        }
        .relationship-lines {
            position: relative;
            width: 100%;
            min-height: 50px; /* Adjust as needed */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px; /* Tailwind max-w-lg */
            margin-left: auto;
            margin-right: auto;
            height: 300px; /* Base height */
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md breakpoint */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .details-section {
            background-color: #f8fafc; /* slate-50 */
            border: 1px solid #e2e8f0; /* slate-200 */
            border-radius: 0.375rem; /* rounded-md */
            padding: 1rem;
            margin-top: 0.5rem;
        }
        .accordion-button {
            background-color: #f1f5f9; /* slate-100 */
            color: #1e293b; /* slate-800 */
            cursor: pointer;
            padding: 0.75rem 1rem;
            width: 100%;
            text-align: left;
            border: none;
            border-radius: 0.375rem; /* rounded-md */
            outline: none;
            transition: background-color 0.3s ease;
            font-weight: 500;
        }
        .accordion-button:hover {
            background-color: #e2e8f0; /* slate-200 */
        }
        .accordion-content {
            padding: 0.75rem;
            background-color: white;
            border: 1px solid #e2e8f0; /* slate-200 */
            border-top: none;
            border-radius: 0 0 0.375rem 0.375rem; /* rounded-b-md */
            display: none;
        }
        .accordion-content.active {
            display: block;
        }
        .flow-step {
            background-color: #e0f2fe; /* sky-100 */
            border: 1px dashed #7dd3fc; /* sky-300 */
            padding: 0.75rem;
            border-radius: 0.375rem; /* rounded-md */
            text-align: center;
        }
        .flow-arrow {
            font-size: 1.5rem; /* text-2xl */
            color: #38bdf8; /* sky-400 */
            margin: 0 0.5rem;
            align-self: center;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 p-4 md:p-8">
    <div class="container mx-auto max-w-6xl bg-white shadow-xl rounded-lg p-6 md:p-10">
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-sky-700">Thi·∫øt K·∫ø C∆° S·ªü D·ªØ Li·ªáu H·ªá Th·ªëng Th∆∞∆°ng M·∫°i ƒêi·ªán T·ª≠</h1>
            <p class="text-slate-600 mt-2">Kh√°m ph√° t∆∞∆°ng t√°c v·ªÅ RBAC v√† Qu·∫£n l√Ω Kho N√¥ng S·∫£n</p>
        </header>

        <nav class="mb-8">
            <ul class="flex flex-wrap justify-center border-b border-slate-300">
                <li class="mr-1"><button data-tab="intro" class="tab-button active-tab bg-sky-600 text-white py-2 px-4 rounded-t-lg focus:outline-none">Gi·ªõi Thi·ªáu</button></li>
                <li class="mr-1"><button data-tab="core-entities" class="tab-button py-2 px-4 rounded-t-lg hover:bg-sky-100 focus:outline-none">Th·ª±c Th·ªÉ C·ªët L√µi</button></li>
                <li class="mr-1"><button data-tab="rbac" class="tab-button py-2 px-4 rounded-t-lg hover:bg-sky-100 focus:outline-none">RBAC</button></li>
                <li class="mr-1"><button data-tab="farm-management" class="tab-button py-2 px-4 rounded-t-lg hover:bg-sky-100 focus:outline-none">QL Kho N√¥ng S·∫£n</button></li>
                <li class="mr-1"><button data-tab="schema" class="tab-button py-2 px-4 rounded-t-lg hover:bg-sky-100 focus:outline-none">L∆∞·ª£c ƒê·ªì T√≠ch H·ª£p</button></li>
                <li class="mr-1"><button data-tab="best-practices" class="tab-button py-2 px-4 rounded-t-lg hover:bg-sky-100 focus:outline-none">Th·ª±c Ti·ªÖn T·ªët</button></li>
                <li><button data-tab="conclusion" class="tab-button py-2 px-4 rounded-t-lg hover:bg-sky-100 focus:outline-none">K·∫øt Lu·∫≠n</button></li>
            </ul>
        </nav>

        <main>
            <section id="intro" class="tab-content active">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">1. Gi·ªõi Thi·ªáu Chung</h2>
                <p class="mb-4 text-slate-700 leading-relaxed">Ph·∫ßn n√†y t√≥m t·∫Øt m·ª•c ti√™u c·ªßa b√°o c√°o thi·∫øt k·∫ø c∆° s·ªü d·ªØ li·ªáu: x√¢y d·ª±ng m·ªôt h·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ to√†n di·ªán, t√≠ch h·ª£p Ki·ªÉm so√°t Truy c·∫≠p D·ª±a tr√™n Vai tr√≤ (RBAC) v√† qu·∫£n l√Ω kho chuy√™n bi·ªát cho n√¥ng s·∫£n. Thi·∫øt k·∫ø nh·∫•n m·∫°nh b·∫£o m·∫≠t, t√≠nh to√†n v·∫πn d·ªØ li·ªáu, kh·∫£ nƒÉng m·ªü r·ªông v√† hi·ªáu qu·∫£, ƒë·∫∑c bi·ªát l√† vi·ªác theo d√µi l√¥ h√†ng v√† ng√†y h·∫øt h·∫°n c·ªßa n√¥ng s·∫£n.</p>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-sky-50 p-4 rounded-lg shadow">
                        <h3 class="font-semibold text-sky-600 mb-2">üéØ M·ª•c Ti√™u Ch√≠nh</h3>
                        <p class="text-sm text-slate-600">X√¢y d·ª±ng DB TMƒêT an to√†n, m·ªü r·ªông v·ªõi RBAC v√† qu·∫£n l√Ω kho n√¥ng s·∫£n hi·ªáu qu·∫£.</p>
                    </div>
                    <div class="bg-sky-50 p-4 rounded-lg shadow">
                        <h3 class="font-semibold text-sky-600 mb-2">üîë Nguy√™n T·∫Øc C·ªët L√µi</h3>
                        <p class="text-sm text-slate-600">ƒê·∫∑c quy·ªÅn t·ªëi thi·ªÉu, to√†n v·∫πn d·ªØ li·ªáu, kh·∫£ nƒÉng m·ªü r·ªông, theo d√µi l√¥ h√†ng & HSD.</p>
                    </div>
                    <div class="bg-sky-50 p-4 rounded-lg shadow">
                        <h3 class="font-semibold text-sky-600 mb-2">üë§ Vai Tr√≤ Ng∆∞·ªùi D√πng</h3>
                        <p class="text-sm text-slate-600">Qu·∫£n l√Ω Kh√°ch h√†ng, Ng∆∞·ªùi b√°n, Qu·∫£n tr·ªã vi√™n, Nh√¢n vi√™n, N√¥ng tr·∫°i.</p>
                    </div>
                </div>
                 <p class="mt-6 text-slate-700 leading-relaxed">Ki·∫øn tr√∫c c∆° s·ªü d·ªØ li·ªáu n√†y kh√¥ng ch·ªâ t·∫≠p trung v√†o c√°c giao d·ªãch th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ ti√™u chu·∫©n m√† c√≤n gi·∫£i quy·∫øt c√°c th√°ch th·ª©c ƒë·∫∑c th√π c·ªßa vi·ªác qu·∫£n l√Ω s·∫£n ph·∫©m n√¥ng nghi·ªáp, n∆°i vi·ªác theo d√µi ngu·ªìn g·ªëc v√† ƒë·ªô t∆∞∆°i c·ªßa s·∫£n ph·∫©m l√† t·ªëi quan tr·ªçng. Vi·ªác t√≠ch h·ª£p RBAC ƒë·∫£m b·∫£o r·∫±ng c√°c nh√≥m ng∆∞·ªùi d√πng kh√°c nhau ch·ªâ c√≥ quy·ªÅn truy c·∫≠p v√†o d·ªØ li·ªáu v√† ch·ª©c nƒÉng ph√π h·ª£p v·ªõi vai tr√≤ c·ªßa h·ªç, tƒÉng c∆∞·ªùng b·∫£o m·∫≠t v√† hi·ªáu qu·∫£ ho·∫°t ƒë·ªông.</p>
            </section>

            <section id="core-entities" class="tab-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">2. C√°c Th·ª±c Th·ªÉ Th∆∞∆°ng M·∫°i ƒêi·ªán T·ª≠ C·ªët L√µi (M·ª•c 2.1, 4 B√°o C√°o)</h2>
                <p class="mb-6 text-slate-700 leading-relaxed">H·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n c√°c th·ª±c th·ªÉ d·ªØ li·ªáu c·ªët l√µi. Nh·∫•p v√†o t·ª´ng b·∫£ng ƒë·ªÉ xem c√°c tr∆∞·ªùng ch√≠nh. ƒê√¢y l√† n·ªÅn t·∫£ng cho c√°c ho·∫°t ƒë·ªông giao d·ªãch v√† qu·∫£n l√Ω danh m·ª•c.</p>
                <div id="coreEntitiesContainer" class="space-y-4"></div>
            </section>

            <section id="rbac" class="tab-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">3. Ki·ªÉm So√°t Truy C·∫≠p D·ª±a Tr√™n Vai Tr√≤ (RBAC) (M·ª•c 3, 5, 6 B√°o C√°o)</h2>
                <p class="mb-4 text-slate-700 leading-relaxed">RBAC l√† m·ªôt m√¥ h√¨nh qu·∫£n l√Ω quy·ªÅn truy c·∫≠p d·ª±a tr√™n vai tr√≤ c·ªßa ng∆∞·ªùi d√πng trong t·ªï ch·ª©c. N√≥ gi√∫p ƒë∆°n gi·∫£n h√≥a vi·ªác qu·∫£n l√Ω quy·ªÅn v√† tƒÉng c∆∞·ªùng b·∫£o m·∫≠t.</p>
                
                <div class="mb-6">
                    <button class="accordion-button">C√°c Kh√°i Ni·ªám C·ªët L√µi c·ªßa RBAC</button>
                    <div class="accordion-content">
                        <ul class="list-disc pl-5 space-y-2 text-slate-600">
                            <li><strong>Ng∆∞·ªùi d√πng:</strong> C√°c c√° nh√¢n ho·∫∑c th·ª±c th·ªÉ truy c·∫≠p h·ªá th·ªëng (kh√°ch h√†ng, ng∆∞·ªùi b√°n, admin,...).</li>
                            <li><strong>Vai tr√≤:</strong> T·∫≠p h·ª£p c√°c quy·ªÅn h·∫°n ph·∫£n √°nh ch·ª©c nƒÉng c√¥ng vi·ªác (v√≠ d·ª•: 'Ng∆∞·ªùi B√°n', 'Qu·∫£n Tr·ªã Vi√™n').</li>
                            <li><strong>Quy·ªÅn h·∫°n:</strong> Quy·ªÅn truy c·∫≠p c·ª• th·ªÉ ƒë·ªÉ th·ª±c hi·ªán h√†nh ƒë·ªông tr√™n t√†i nguy√™n (v√≠ d·ª•: 's·∫£n ph·∫©m:t·∫°o', 'ƒë∆°n_h√†ng:xem').</li>
                        </ul>
                    </div>
                </div>

                <div class="mb-6">
                    <button class="accordion-button">C√°c Nguy√™n T·∫Øc Ch√≠nh c·ªßa RBAC</button>
                    <div class="accordion-content">
                         <ul class="list-disc pl-5 space-y-2 text-slate-600">
                            <li><strong>ƒê·∫∑c quy·ªÅn t·ªëi thi·ªÉu:</strong> Ch·ªâ c·∫•p quy·ªÅn truy c·∫≠p t·ªëi thi·ªÉu c·∫ßn thi·∫øt.</li>
                            <li><strong>Ph√¢n t√°ch nhi·ªám v·ª•:</strong> Ph√¢n chia tr√°ch nhi·ªám ƒë·ªÉ tr√°nh xung ƒë·ªôt l·ª£i √≠ch v√† gian l·∫≠n.</li>
                            <li><strong>Tr·ª´u t∆∞·ª£ng h√≥a d·ªØ li·ªáu:</strong> ·∫®n c√°c chi ti·∫øt ph·ª©c t·∫°p, cung c·∫•p giao di·ªán ƒë∆°n gi·∫£n.</li>
                        </ul>
                    </div>
                </div>
                
                <h3 class="text-xl font-semibold text-sky-600 mb-3 mt-6">C√°c B·∫£ng RBAC C·ªët L√µi</h3>
                <div id="rbacTablesContainer" class="space-y-4 mb-6"></div>

                <h3 class="text-xl font-semibold text-sky-600 mb-3 mt-6">ƒê·ªãnh Nghƒ©a C√°c Vai Tr√≤ C·ª• Th·ªÉ</h3>
                <p class="mb-4 text-slate-700">Ch·ªçn m·ªôt vai tr√≤ ƒë·ªÉ xem m√¥ t·∫£ v√† c√°c quy·ªÅn h·∫°n li√™n quan.</p>
                <select id="roleSelector" class="w-full md:w-1/2 p-2 border border-slate-300 rounded-md mb-4 focus:ring-sky-500 focus:border-sky-500">
                    <option value="">-- Ch·ªçn Vai Tr√≤ --</option>
                </select>
                <div id="roleDetails" class="details-section min-h-[100px]">
                    <p class="text-slate-500">Th√¥ng tin chi ti·∫øt v·ªÅ vai tr√≤ s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y.</p>
                </div>

                <h3 class="text-xl font-semibold text-sky-600 mb-3 mt-8">Bi·ªÉu ƒê·ªì Minh H·ªça (D·ªØ li·ªáu m·∫´u)</h3>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h4 class="text-lg font-medium text-center text-slate-700 mb-2">Ph√¢n B·ªë Vai Tr√≤ Ng∆∞·ªùi D√πng (Minh H·ªça)</h4>
                        <div class="chart-container bg-white p-2 rounded-lg shadow">
                            <canvas id="roleDistributionChart"></canvas>
                        </div>
                        <p class="text-xs text-center text-slate-500 mt-1">Bi·ªÉu ƒë·ªì n√†y minh h·ªça t·ª∑ l·ªá c√°c lo·∫°i ng∆∞·ªùi d√πng trong h·ªá th·ªëng (d·ªØ li·ªáu m·∫´u).</p>
                    </div>
                    <div>
                        <h4 class="text-lg font-medium text-center text-slate-700 mb-2">S·ªë L∆∞·ª£ng Quy·ªÅn H·∫°n Theo Module (Minh H·ªça)</h4>
                        <div class="chart-container bg-white p-2 rounded-lg shadow">
                            <canvas id="permissionsPerModuleChart"></canvas>
                        </div>
                         <p class="text-xs text-center text-slate-500 mt-1">Bi·ªÉu ƒë·ªì n√†y minh h·ªça s·ª± ph√¢n b·ªï quy·ªÅn h·∫°n theo c√°c module ch·ª©c nƒÉng (d·ªØ li·ªáu m·∫´u).</p>
                    </div>
                </div>
            </section>

            <section id="farm-management" class="tab-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">4. Qu·∫£n L√Ω Kho N√¥ng S·∫£n Chuy√™n Bi·ªát (M·ª•c 7 B√°o C√°o)</h2>
                <p class="mb-6 text-slate-700 leading-relaxed">Ph·∫ßn n√†y t·∫≠p trung v√†o vi·ªác qu·∫£n l√Ω c√°c s·∫£n ph·∫©m n√¥ng nghi·ªáp, ƒë·∫∑c bi·ªát l√† h√†ng h√≥a d·ªÖ h·ªèng, v·ªõi kh·∫£ nƒÉng theo d√µi l√¥ h√†ng v√† ng√†y h·∫øt h·∫°n.</p>
                
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Lu·ªìng Qu·∫£n L√Ω T·ªìn Kho N√¥ng S·∫£n</h3>
                <div class="flex flex-col md:flex-row items-center justify-around p-4 bg-slate-100 rounded-lg mb-6">
                    <div class="flow-step mb-2 md:mb-0">N√¥ng Tr·∫°i (Farms)</div>
                    <div class="flow-arrow transform md:rotate-0 rotate-90">‚ûî</div>
                    <div class="flow-step mb-2 md:mb-0">S·∫£n Ph·∫©m N√¥ng Tr·∫°i (FarmProducts)</div>
                    <div class="flow-arrow transform md:rotate-0 rotate-90">‚ûî</div>
                    <div class="flow-step mb-2 md:mb-0">L√¥ H√†ng (Batches)</div>
                    <div class="flow-arrow transform md:rotate-0 rotate-90">‚ûî</div>
                    <div class="flow-step">T·ªìn Kho (Inventory)</div>
                </div>
                <p class="mb-4 text-slate-700 leading-relaxed">Quy tr√¨nh n√†y ƒë·∫£m b·∫£o kh·∫£ nƒÉng truy xu·∫•t ngu·ªìn g·ªëc t·ª´ n√¥ng tr·∫°i ƒë·∫øn tay ng∆∞·ªùi ti√™u d√πng, qu·∫£n l√Ω hi·ªáu qu·∫£ h·∫°n s·ª≠ d·ª•ng (FEFO - H·∫øt h·∫°n tr∆∞·ªõc, xu·∫•t tr∆∞·ªõc) v√† gi·∫£m thi·ªÉu l√£ng ph√≠.</p>

                <h3 class="text-xl font-semibold text-sky-600 mb-3 mt-6">C√°c B·∫£ng Qu·∫£n L√Ω N√¥ng S·∫£n</h3>
                <div id="farmTablesContainer" class="space-y-4"></div>
                 <div class="mt-6 bg-sky-50 p-4 rounded-lg shadow">
                    <h4 class="font-semibold text-sky-600 mb-2">Chi·∫øn L∆∞·ª£c FEFO (First Expired, First Out)</h4>
                    <p class="text-sm text-slate-600 leading-relaxed">Khi x·ª≠ l√Ω ƒë∆°n h√†ng cho s·∫£n ph·∫©m d·ªÖ h·ªèng, h·ªá th·ªëng ∆∞u ti√™n xu·∫•t c√°c l√¥ h√†ng c√≥ ng√†y h·∫øt h·∫°n s·ªõm nh·∫•t. ƒêi·ªÅu n√†y ƒë√≤i h·ªèi truy v·∫•n b·∫£ng `Batches`, s·∫Øp x·∫øp theo `expiry_date` v√† c·∫≠p nh·∫≠t `current_quantity`. B·∫£ng `OrderItems` s·∫Ω ghi l·∫°i `batch_id` c·ªßa s·∫£n ph·∫©m ƒë∆∞·ª£c giao ƒë·ªÉ ƒë·∫£m b·∫£o truy xu·∫•t ngu·ªìn g·ªëc.</p>
                </div>
            </section>

            <section id="schema" class="tab-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">5. L∆∞·ª£c ƒê·ªì C∆° S·ªü D·ªØ Li·ªáu T√≠ch H·ª£p (T·ªïng Quan ERD - M·ª•c 8 B√°o C√°o)</h2>
                <p class="mb-6 text-slate-700 leading-relaxed">S∆° ƒë·ªì quan h·ªá th·ª±c th·ªÉ (ERD) cung c·∫•p c√°i nh√¨n t·ªïng quan v·ªÅ c√°c b·∫£ng v√† m·ªëi quan h·ªá c·ªßa ch√∫ng. D∆∞·ªõi ƒë√¢y l√† m·ªôt bi·ªÉu di·ªÖn t∆∞∆°ng t√°c ƒë∆°n gi·∫£n h√≥a. Nh·∫•p v√†o m·ªôt b·∫£ng ƒë·ªÉ xem c√°c b·∫£ng li√™n quan ch√≠nh c·ªßa n√≥ (m·ªëi quan h·ªá ƒë∆∞·ª£c ƒë√°nh d·∫•u m√†u).</p>
                
                <div class="table-diagram-container" id="interactiveErd">
                    </div>
                <div id="relationshipInfo" class="mt-4 p-3 bg-sky-50 rounded-md text-sm text-sky-700 min-h-[50px]">
                    Ch·ªçn m·ªôt b·∫£ng ƒë·ªÉ xem c√°c m·ªëi quan h·ªá c·ªßa n√≥.
                </div>
            </section>

            <section id="best-practices" class="tab-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">6. C√°c Th·ª±c Ti·ªÖn T·ªët Nh·∫•t V·ªÅ B·∫£o M·∫≠t v√† Tri·ªÉn Khai (M·ª•c 9 B√°o C√°o)</h2>
                <div class="space-y-4">
                    <div>
                        <button class="accordion-button">Chu·∫©n H√≥a D·ªØ Li·ªáu v√† C√°c M·ªëi Quan H·ªá</button>
                        <div class="accordion-content">
                            <p class="text-slate-600">Gi·∫£m d∆∞ th·ª´a, c·∫£i thi·ªán t√≠nh to√†n v·∫πn d·ªØ li·ªáu th√¥ng qua vi·ªác t·ªï ch·ª©c b·∫£ng v√† c·ªôt h·ª£p l√Ω. S·ª≠ d·ª•ng kh√≥a ch√≠nh, kh√≥a ngo·∫°i ƒë·ªÉ th·ª±c thi m·ªëi quan h·ªá v√† t√≠nh to√†n v·∫πn tham chi·∫øu.</p>
                        </div>
                    </div>
                    <div>
                        <button class="accordion-button">Th·ª±c Thi Ki·ªÉm So√°t Truy C·∫≠p v√† Ki·ªÉm To√°n</button>
                        <div class="accordion-content">
                            <p class="text-slate-600">L·ªõp ·ª©ng d·ª•ng ph·∫£i truy v·∫•n c√°c b·∫£ng RBAC (`UserRoles`, `RolePermissions`) ƒë·ªÉ x√°c ƒë·ªãnh quy·ªÅn h·∫°n c·ªßa ng∆∞·ªùi d√πng. Ghi nh·∫≠t k√Ω ho·∫°t ƒë·ªông v√† c√°c n·ªó l·ª±c truy c·∫≠p ƒë·ªÉ theo d√µi v√† tu√¢n th·ªß.</p>
                        </div>
                    </div>
                    <div>
                        <button class="accordion-button">Kh·∫£ NƒÉng M·ªü R·ªông v√† T·ªëi ∆Øu H√≥a Hi·ªáu Su·∫•t</button>
                        <div class="accordion-content">
                            <p class="text-slate-600">S·ª≠ d·ª•ng ch·ªâ m·ª•c chi·∫øn l∆∞·ª£c cho c√°c c·ªôt th∆∞·ªùng xuy√™n truy v·∫•n. Xem x√©t ph√¢n v√πng cho c√°c b·∫£ng l·ªõn. L·ª±a ch·ªçn c∆° s·ªü d·ªØ li·ªáu ph√π h·ª£p (SQL cho giao d·ªãch, NoSQL cho d·ªØ li·ªáu √≠t c·∫•u tr√∫c).</p>
                        </div>
                    </div>
                    <div>
                        <button class="accordion-button">B·∫£o M·∫≠t D·ªØ Li·ªáu v√† Tu√¢n Th·ªß</button>
                        <div class="accordion-content">
                            <p class="text-slate-600">M√£ h√≥a d·ªØ li·ªáu nh·∫°y c·∫£m (m·∫≠t kh·∫©u, thanh to√°n) khi l∆∞u tr·ªØ v√† truy·ªÅn t·∫£i. L∆∞u tr·ªØ m·∫≠t kh·∫©u d∆∞·ªõi d·∫°ng m√£ bƒÉm. ƒê·ªãnh k·ª≥ xem x√©t v√† c·∫≠p nh·∫≠t vai tr√≤, quy·ªÅn h·∫°n.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="conclusion" class="tab-content">
                <h2 class="text-2xl font-semibold text-sky-700 mb-4">7. K·∫øt Lu·∫≠n v√† C√°c C·∫£i Ti·∫øn T∆∞∆°ng Lai (M·ª•c 10 B√°o C√°o)</h2>
                <p class="mb-4 text-slate-700 leading-relaxed">Thi·∫øt k·∫ø c∆° s·ªü d·ªØ li·ªáu n√†y cung c·∫•p m·ªôt n·ªÅn t·∫£ng m·∫°nh m·∫Ω, c√≥ kh·∫£ nƒÉng m·ªü r·ªông v√† an to√†n. Vi·ªác t√≠ch h·ª£p RBAC v√† qu·∫£n l√Ω t·ªìn kho n√¥ng s·∫£n chuy√™n bi·ªát gi·∫£i quy·∫øt c√°c y√™u c·∫ßu c·ªët l√µi c·ªßa h·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ hi·ªán ƒë·∫°i, ƒë·∫∑c bi·ªát trong lƒ©nh v·ª±c n√¥ng s·∫£n.</p>
                <h3 class="text-xl font-semibold text-sky-600 mb-3">C√°c C·∫£i Ti·∫øn T∆∞∆°ng Lai Ti·ªÅm NƒÉng:</h3>
                <ul class="list-disc pl-5 space-y-2 text-slate-600">
                    <li><strong>Ki·ªÉm so√°t Truy c·∫≠p D·ª±a tr√™n Thu·ªôc t√≠nh (ABAC):</strong> Cho ph√©p ·ªßy quy·ªÅn chi ti·∫øt h∆°n d·ª±a tr√™n thu·ªôc t√≠nh c·ªßa ng∆∞·ªùi d√πng, t√†i nguy√™n v√† m√¥i tr∆∞·ªùng, t·∫°o ra c√°c ch√≠nh s√°ch ƒë·ªông h∆°n.</li>
                    <li><strong>·ª¶y quy·ªÅn Vai tr√≤:</strong> Cho ph√©p vai tr√≤ ·ªßy quy·ªÅn m·ªôt ph·∫ßn quy·ªÅn h·∫°n cho ng∆∞·ªùi d√πng kh√°c trong th·ªùi gian gi·ªõi h·∫°n.</li>
                    <li><strong>Ph√¢n t√≠ch N√¢ng cao:</strong> T·∫≠n d·ª•ng d·ªØ li·ªáu l√¥ h√†ng ƒë·ªÉ ph√¢n t√≠ch d·ª± ƒëo√°n v·ªÅ nƒÉng su·∫•t, t·ª∑ l·ªá h∆∞ h·ªèng, v√† ƒë·ªãnh gi√°.</li>
                    <li><strong>T√≠ch h·ª£p Blockchain:</strong> TƒÉng c∆∞·ªùng t√≠nh minh b·∫°ch v√† b·∫•t bi·∫øn c·ªßa h·ªì s∆° l√¥ h√†ng v√† chu·ªói cung ·ª©ng.</li>
                </ul>
            </section>
        </main>

        <footer class="mt-12 pt-8 border-t border-slate-300 text-center">
            <p class="text-sm text-slate-500">&copy; <span id="currentYear"></span> Kh√°m Ph√° Thi·∫øt K·∫ø DB Ecommerce. D·ª±a tr√™n b√°o c√°o ƒë∆∞·ª£c cung c·∫•p.</p>
        </footer>
    </div>

    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const tabs = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(item => {
                    item.classList.remove('active-tab', 'bg-sky-600', 'text-white');
                    item.classList.add('hover:bg-sky-100');
                });
                tab.classList.add('active-tab', 'bg-sky-600', 'text-white');
                tab.classList.remove('hover:bg-sky-100');
                
                const target = tab.getAttribute('data-tab');
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === target) {
                        content.classList.add('active');
                    }
                });
            });
        });

        const accordions = document.querySelectorAll('.accordion-button');
        accordions.forEach(accordion => {
            accordion.addEventListener('click', () => {
                accordion.classList.toggle('active');
                const content = accordion.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
                // Close other accordions in the same group if needed
            });
        });
        
        // Data for tables (simplified from report)
        const dbSchema = {
            core: [
                { name: 'Users (Ng∆∞·ªùi d√πng)', fields: ['user_id (PK)', 'username', 'email', 'password_hash', 'status', 'registered_at'] , description: "L∆∞u tr·ªØ th√¥ng tin chung v·ªÅ t·∫•t c·∫£ ng∆∞·ªùi d√πng h·ªá th·ªëng."},
                { name: 'Addresses (ƒê·ªãa ch·ªâ)', fields: ['address_id (PK)', 'user_id (FK)', 'street', 'city', 'address_type'], description: "L∆∞u tr·ªØ nhi·ªÅu ƒë·ªãa ch·ªâ cho ng∆∞·ªùi d√πng."},
                { name: 'Products (S·∫£n ph·∫©m)', fields: ['product_id (PK)', 'name', 'description', 'price', 'sku', 'is_active'], description: "Th√¥ng tin chung v·ªÅ t·∫•t c·∫£ s·∫£n ph·∫©m."},
                { name: 'Categories (Danh m·ª•c)', fields: ['category_id (PK)', 'name', 'parent_category_id (FK)'], description: "T·ªï ch·ª©c s·∫£n ph·∫©m th√†nh c√°c nh√≥m h·ª£p l√Ω."},
                { name: 'ProductCategories', fields: ['product_id (FK)', 'category_id (FK)'], description: "B·∫£ng n·ªëi Products v√† Categories (N-N)."},
                { name: 'Orders (ƒê∆°n h√†ng)', fields: ['order_id (PK)', 'user_id (FK)', 'order_date', 'total_amount', 'status'], description: "L∆∞u tr·ªØ chi ti·∫øt v·ªÅ c√°c ƒë∆°n h√†ng."},
                { name: 'OrderItems (M·∫∑t h√†ng ƒêH)', fields: ['order_item_id (PK)', 'order_id (FK)', 'product_id (FK)', 'quantity', 'unit_price'], description: "Chi ti·∫øt c√°c s·∫£n ph·∫©m trong m·ªôt ƒë∆°n h√†ng."},
                { name: 'Payments (Thanh to√°n)', fields: ['payment_id (PK)', 'order_id (FK)', 'amount', 'payment_method', 'status'], description: "Ghi l·∫°i c√°c giao d·ªãch thanh to√°n."},
                { name: 'Carts (Gi·ªè h√†ng)', fields: ['cart_id (PK)', 'user_id (FK)', 'created_at', 'is_active'], description: "ƒê·∫°i di·ªán cho gi·ªè h√†ng c·ªßa ng∆∞·ªùi d√πng."},
                { name: 'CartItems (M·∫∑t h√†ng GH)', fields: ['cart_item_id (PK)', 'cart_id (FK)', 'product_id (FK)', 'quantity'], description: "Chi ti·∫øt s·∫£n ph·∫©m trong gi·ªè h√†ng."}
            ],
            rbac: [
                { name: 'Roles (Vai tr√≤)', fields: ['role_id (PK)', 'title', 'slug', 'description', 'is_active'], description: "ƒê·ªãnh nghƒ©a c√°c vai tr√≤ kh√°c nhau trong h·ªá th·ªëng."},
                { name: 'Permissions (Quy·ªÅn h·∫°n)', fields: ['permission_id (PK)', 'title', 'slug', 'module', 'is_active'], description: "ƒê·ªãnh nghƒ©a c√°c h√†nh ƒë·ªông chi ti·∫øt c√≥ th·ªÉ th·ª±c hi·ªán."},
                { name: 'UserRoles', fields: ['user_id (FK)', 'role_id (FK)', 'assigned_at'], description: "√Ånh x·∫° ng∆∞·ªùi d√πng v·ªõi vai tr√≤ (N-N)."},
                { name: 'RolePermissions', fields: ['role_id (FK)', 'permission_id (FK)', 'assigned_at'], description: "√Ånh x·∫° vai tr√≤ v·ªõi quy·ªÅn h·∫°n (N-N)."}
            ],
            farm: [
                { name: 'Farms (N√¥ng tr·∫°i)', fields: ['farm_id (PK)', 'user_id (FK)', 'name', 'location', 'status'], description: "Th√¥ng tin v·ªÅ c√°c n√¥ng tr·∫°i cung c·∫•p s·∫£n ph·∫©m."},
                { name: 'FarmProducts (SP N√¥ng tr·∫°i)', fields: ['farm_product_id (PK)', 'farm_id (FK)', 'product_id (FK)', 'farm_specific_sku'], description: "Li√™n k·∫øt Products chung v·ªõi Farms c·ª• th·ªÉ."},
                { name: 'Batches (L√¥ h√†ng)', fields: ['batch_id (PK)', 'farm_product_id (FK)', 'batch_number', 'expiry_date', 'current_quantity'], description: "Theo d√µi l√¥ s·∫£n ph·∫©m d·ªÖ h·ªèng v√† ng√†y h·∫øt h·∫°n."},
                { name: 'Inventory (T·ªìn kho)', fields: ['inventory_id (PK)', 'farm_product_id (FK)', 'batch_id (FK)', 'quantity_on_hand'], description: "Theo d√µi m·ª©c t·ªìn kho hi·ªán t·∫°i, li√™n k·∫øt v·ªõi l√¥ h√†ng."}
            ]
        };

        const rolesData = {
            customer: { 
                description: "Ng∆∞·ªùi d√πng cu·ªëi ti√™u chu·∫©n duy·ªát s·∫£n ph·∫©m, mua h√†ng v√† xem l·ªãch s·ª≠ ƒë∆°n h√†ng c·ªßa ch√≠nh h·ªç.",
                permissions: ['s·∫£n_ph·∫©m:xem_t·∫•t_c·∫£', 'gi·ªè_h√†ng:qu·∫£n_l√Ω_c·ªßa_ri√™ng', 'ƒë∆°n_h√†ng:ƒë·∫∑t_c·ªßa_ri√™ng', 'ƒë∆°n_h√†ng:xem_c·ªßa_ri√™ng', 'ng∆∞·ªùi_d√πng:qu·∫£n_l√Ω_h·ªì_s∆°_c·ªßa_ri√™ng', 'thanh_to√°n:th·ª±c_hi·ªán_c·ªßa_ri√™ng', 'ƒë√°nh_gi√°:qu·∫£n_l√Ω_c·ªßa_ri√™ng']
            },
            seller: {
                description: "Ng∆∞·ªùi d√πng li·ªát k√™ v√† b√°n s·∫£n ph·∫©m n√¥ng nghi·ªáp. H·ªç qu·∫£n l√Ω h√†ng t·ªìn kho, ƒë∆°n h√†ng v√† doanh s·ªë c·ªßa ri√™ng h·ªç.",
                permissions: ['s·∫£n_ph·∫©m:qu·∫£n_l√Ω_c·ªßa_ri√™ng', 't·ªìn_kho:qu·∫£n_l√Ω_c·ªßa_ri√™ng', 'ƒë∆°n_h√†ng:xem_ƒë∆°n_h√†ng_ng∆∞·ªùi_b√°n', 'ƒë∆°n_h√†ng:c·∫≠p_nh·∫≠t_tr·∫°ng_th√°i_ng∆∞·ªùi_b√°n', 'b√°o_c√°o_doanh_s·ªë:xem_c·ªßa_ri√™ng', 'n√¥ng_tr·∫°i:qu·∫£n_l√Ω_chi_ti·∫øt_c·ªßa_ri√™ng (n·∫øu c√≥)']
            },
            admin: {
                description: "Gi√°m s√°t to√†n b·ªô h·ªá th·ªëng, qu·∫£n l√Ω ng∆∞·ªùi d√πng v√† vai tr√≤, c·∫•u h√¨nh to√†n c·∫ßu.",
                permissions: ['ng∆∞·ªùi_d√πng:qu·∫£n_l√Ω_t·∫•t_c·∫£', 'vai_tr√≤:qu·∫£n_l√Ω_t·∫•t_c·∫£', 'quy·ªÅn_h·∫°n:qu·∫£n_l√Ω_t·∫•t_c·∫£', 's·∫£n_ph·∫©m:qu·∫£n_l√Ω_t·∫•t_c·∫£', 'ƒë∆°n_h√†ng:qu·∫£n_l√Ω_t·∫•t_c·∫£', 'danh_m·ª•c:qu·∫£n_l√Ω_t·∫•t_c·∫£', 'thanh_to√°n:x·ª≠_l√Ω_ho√†n_ti·ªÅn_t·∫•t_c·∫£', 'c√†i_ƒë·∫∑t_th∆∞∆°ng_m·∫°i_ƒëi·ªán_t·ª≠:ch·ªânh_s·ª≠a_t·∫•t_c·∫£', 'b√°o_c√°o:xem_t·∫•t_c·∫£', 'nh·∫≠t_k√Ω_ki·ªÉm_to√°n:xem_t·∫•t_c·∫£']
            },
            staff: {
                description: "Truy c·∫≠p b·∫£ng qu·∫£n tr·ªã c·ª• th·ªÉ (v√≠ d·ª•: h·ªó tr·ª£ kh√°ch h√†ng, qu·∫£n l√Ω n·ªôi dung, x·ª≠ l√Ω ƒë∆°n h√†ng) v·ªõi quy·ªÅn h·∫°n ch·∫ø.",
                permissions: ['ƒë∆°n_h√†ng:xem_t·∫•t_c·∫£ (h·∫°n ch·∫ø)', 'ƒë∆°n_h√†ng:c·∫≠p_nh·∫≠t_tr·∫°ng_th√°i (th·ª±c hi·ªán)', 'h·ªó_tr·ª£_kh√°ch_h√†ng:qu·∫£n_l√Ω_y√™u_c·∫ßu', 'n·ªôi_dung:qu·∫£n_l√Ω_c∆°_b·∫£n', 'm√£_gi·∫£m_gi√°:qu·∫£n_l√Ω']
            },
            farm_role: { // Changed key to avoid conflict with 'farm' in dbSchema
                description: "ƒê·∫°i di·ªán n√¥ng tr·∫°i, qu·∫£n l√Ω s·∫£n ph·∫©m, l√¥ h√†ng v√† t·ªìn kho c·ªßa n√¥ng tr·∫°i m√¨nh.",
                permissions: ['s·∫£n_ph·∫©m_n√¥ng_tr·∫°i:qu·∫£n_l√Ω_c·ªßa_ri√™ng', 'l√¥_h√†ng:qu·∫£n_l√Ω_c·ªßa_ri√™ng', 't·ªìn_kho:qu·∫£n_l√Ω_t·ªìn_kho_n√¥ng_tr·∫°i', 'b√°o_c√°o_n√¥ng_tr·∫°i:xem_c·ªßa_ri√™ng', 'h·ªì_s∆°_n√¥ng_tr·∫°i:qu·∫£n_l√Ω_c·ªßa_ri√™ng']
            }
        };
        
        function createTableCard(table) {
            const card = document.createElement('div');
            card.className = 'p-4 border border-slate-300 rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer bg-white';
            card.innerHTML = `<h4 class="font-semibold text-sky-700 mb-2">${table.name}</h4>
                              <p class="text-xs text-slate-500 mb-2 italic">${table.description}</p>
                              <button class="text-xs text-sky-600 hover:underline focus:outline-none toggle-details-btn">Xem/·∫®n Tr∆∞·ªùng</button>
                              <ul class="text-sm text-slate-600 mt-2 space-y-1 hidden">
                                  ${table.fields.map(field => `<li>${field.replace('(PK)', '<strong class="text-amber-600">(PK)</strong>').replace('(FK)', '<strong class="text-emerald-600">(FK)</strong>')}</li>`).join('')}
                              </ul>`;
            card.querySelector('.toggle-details-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                const ul = card.querySelector('ul');
                ul.classList.toggle('hidden');
                e.target.textContent = ul.classList.contains('hidden') ? 'Xem Tr∆∞·ªùng' : '·∫®n Tr∆∞·ªùng';
            });
            return card;
        }

        const coreEntitiesContainer = document.getElementById('coreEntitiesContainer');
        dbSchema.core.forEach(table => coreEntitiesContainer.appendChild(createTableCard(table)));

        const rbacTablesContainer = document.getElementById('rbacTablesContainer');
        dbSchema.rbac.forEach(table => rbacTablesContainer.appendChild(createTableCard(table)));
        
        const farmTablesContainer = document.getElementById('farmTablesContainer');
        dbSchema.farm.forEach(table => farmTablesContainer.appendChild(createTableCard(table)));

        const roleSelector = document.getElementById('roleSelector');
        const roleDetailsDiv = document.getElementById('roleDetails');

        Object.keys(rolesData).forEach(roleKey => {
            const option = document.createElement('option');
            option.value = roleKey;
            let roleName = roleKey.charAt(0).toUpperCase() + roleKey.slice(1).replace('_role',' (N√¥ng tr·∫°i)');
            if(roleKey === "customer") roleName = "Kh√°ch H√†ng";
            if(roleKey === "seller") roleName = "Ng∆∞·ªùi B√°n";
            if(roleKey === "admin") roleName = "Qu·∫£n Tr·ªã Vi√™n";
            if(roleKey === "staff") roleName = "Nh√¢n Vi√™n";
            option.textContent = roleName;
            roleSelector.appendChild(option);
        });

        roleSelector.addEventListener('change', (event) => {
            const selectedRoleKey = event.target.value;
            if (selectedRoleKey && rolesData[selectedRoleKey]) {
                const role = rolesData[selectedRoleKey];
                roleDetailsDiv.innerHTML = `
                    <h4 class="font-semibold text-lg text-sky-700 mb-2">${roleSelector.options[roleSelector.selectedIndex].text}</h4>
                    <p class="text-slate-700 mb-3"><strong>M√¥ t·∫£:</strong> ${role.description}</p>
                    <strong class="text-slate-700">Quy·ªÅn h·∫°n:</strong>
                    <ul class="list-disc pl-5 mt-1 space-y-1 text-slate-600">
                        ${role.permissions.map(perm => `<li>${perm}</li>`).join('')}
                    </ul>`;
            } else {
                roleDetailsDiv.innerHTML = '<p class="text-slate-500">Th√¥ng tin chi ti·∫øt v·ªÅ vai tr√≤ s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y.</p>';
            }
        });

        // Chart.js Initializations
        // Sample data for charts
        const roleDistributionData = {
            labels: ['Kh√°ch H√†ng', 'Ng∆∞·ªùi B√°n', 'N√¥ng Tr·∫°i', 'Nh√¢n Vi√™n', 'Qu·∫£n Tr·ªã Vi√™n'],
            datasets: [{
                label: 'Ph√¢n B·ªë Vai Tr√≤',
                data: [65, 15, 10, 7, 3], // Sample percentages
                backgroundColor: ['#7dd3fc', '#38bdf8', '#0ea5e9', '#0284c7', '#0369a1'],
                hoverOffset: 4
            }]
        };
        new Chart(document.getElementById('roleDistributionChart'), {
            type: 'pie',
            data: roleDistributionData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { position: 'top' } }
            }
        });

        const permissionsPerModuleData = {
            labels: ['QL S·∫£n Ph·∫©m', 'QL ƒê∆°n H√†ng', 'QL Ng∆∞·ªùi D√πng', 'QL Kho H√†ng', 'B√°o C√°o', 'H·ªá Th·ªëng'],
            datasets: [{
                label: 'S·ªë L∆∞·ª£ng Quy·ªÅn H·∫°n',
                data: [8, 12, 10, 7, 5, 15], // Sample counts
                backgroundColor: '#38bdf8',
                borderColor: '#0284c7',
                borderWidth: 1
            }]
        };
        new Chart(document.getElementById('permissionsPerModuleChart'), {
            type: 'bar',
            data: permissionsPerModuleData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: { y: { beginAtZero: true } },
                plugins: { legend: { display: false } }
            }
        });

        // Interactive ERD
        const erdContainer = document.getElementById('interactiveErd');
        const relationshipInfo = document.getElementById('relationshipInfo');
        const allTables = [...dbSchema.core, ...dbSchema.rbac, ...dbSchema.farm];
        
        const tableMap = new Map();
        allTables.forEach(table => {
            const tableDiv = document.createElement('div');
            tableDiv.className = 'table-block';
            tableDiv.dataset.tableName = table.name;
            tableDiv.innerHTML = `<h4>${table.name}</h4>`;
            
            const fieldsList = document.createElement('ul');
            fieldsList.className = 'hidden'; // Initially hidden
            table.fields.slice(0, 3).forEach(field => { // Show first 3 fields as preview
                 const li = document.createElement('li');
                 li.innerHTML = field.replace('(PK)', '<strong class="text-amber-600">(PK)</strong>').replace('(FK)', '<strong class="text-emerald-600">(FK)</strong>');
                 fieldsList.appendChild(li);
            });
            if (table.fields.length > 3) {
                const li = document.createElement('li');
                li.textContent = '...';
                fieldsList.appendChild(li);
            }
            tableDiv.appendChild(fieldsList);
            
            tableDiv.addEventListener('mouseenter', () => fieldsList.classList.remove('hidden'));
            tableDiv.addEventListener('mouseleave', () => fieldsList.classList.add('hidden'));

            tableDiv.addEventListener('click', () => {
                const selectedTableName = tableDiv.dataset.tableName;
                erdContainer.querySelectorAll('.table-block').forEach(block => block.classList.remove('highlighted', 'opacity-50'));
                
                tableDiv.classList.add('highlighted');
                
                let relatedTables = new Set();
                let relationsText = `<strong>${selectedTableName}</strong> c√≥ c√°c m·ªëi quan h·ªá ch√≠nh v·ªõi: `;
                let foundRelations = false;

                // Define some key relationships (simplified)
                if (selectedTableName === 'Users (Ng∆∞·ªùi d√πng)') {
                    relatedTables.add('Addresses (ƒê·ªãa ch·ªâ)'); relatedTables.add('Orders (ƒê∆°n h√†ng)'); relatedTables.add('Carts (Gi·ªè h√†ng)'); relatedTables.add('UserRoles'); relatedTables.add('Farms (N√¥ng tr·∫°i)');
                } else if (selectedTableName === 'Products (S·∫£n ph·∫©m)') {
                    relatedTables.add('ProductCategories'); relatedTables.add('OrderItems (M·∫∑t h√†ng ƒêH)'); relatedTables.add('CartItems (M·∫∑t h√†ng GH)'); relatedTables.add('FarmProducts (SP N√¥ng tr·∫°i)');
                } else if (selectedTableName === 'Orders (ƒê∆°n h√†ng)') {
                    relatedTables.add('Users (Ng∆∞·ªùi d√πng)'); relatedTables.add('OrderItems (M·∫∑t h√†ng ƒêH)'); relatedTables.add('Payments (Thanh to√°n)'); relatedTables.add('Addresses (ƒê·ªãa ch·ªâ)');
                } else if (selectedTableName === 'Roles (Vai tr√≤)') {
                    relatedTables.add('UserRoles'); relatedTables.add('RolePermissions');
                } else if (selectedTableName === 'Permissions (Quy·ªÅn h·∫°n)') {
                    relatedTables.add('RolePermissions');
                } else if (selectedTableName === 'Farms (N√¥ng tr·∫°i)') {
                    relatedTables.add('Users (Ng∆∞·ªùi d√πng)'); relatedTables.add('FarmProducts (SP N√¥ng tr·∫°i)');
                } else if (selectedTableName === 'FarmProducts (SP N√¥ng tr·∫°i)') {
                    relatedTables.add('Products (S·∫£n ph·∫©m)'); relatedTables.add('Farms (N√¥ng tr·∫°i)'); relatedTables.add('Batches (L√¥ h√†ng)'); relatedTables.add('Inventory (T·ªìn kho)');
                } else if (selectedTableName === 'Batches (L√¥ h√†ng)') {
                    relatedTables.add('FarmProducts (SP N√¥ng tr·∫°i)'); relatedTables.add('Inventory (T·ªìn kho)'); relatedTables.add('OrderItems (M·∫∑t h√†ng ƒêH)'); // For fulfilled_batch_id
                }


                erdContainer.querySelectorAll('.table-block').forEach(block => {
                    if (block.dataset.tableName !== selectedTableName) {
                        if (relatedTables.has(block.dataset.tableName)) {
                            block.classList.add('highlighted');
                            relationsText += `${block.dataset.tableName}, `;
                            foundRelations = true;
                        } else {
                            block.classList.add('opacity-50');
                        }
                    }
                });
                relationshipInfo.innerHTML = foundRelations ? relationsText.slice(0, -2) + '.' : `<strong>${selectedTableName}</strong> kh√¥ng c√≥ m·ªëi quan h·ªá tr·ª±c ti·∫øp n√†o ƒë∆∞·ª£c l√†m n·ªïi b·∫≠t trong s∆° ƒë·ªì ƒë∆°n gi·∫£n n√†y ho·∫∑c l√† b·∫£ng trung t√¢m.`;

            });
            tableMap.set(table.name, tableDiv);
            erdContainer.appendChild(tableDiv);
        });


    </script>
</body>
</html>
